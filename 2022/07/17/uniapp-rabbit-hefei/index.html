<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="uniapp-rabbit目录 uniapp-rabbit 目录 day1 使用 vuecli 创建 uniapp项目 运行和预览uniapp项目 开发的规范 项目目录结构 uniapp生命周期 开发的注意事项 开发的规范小结：   uniapp的api easycom 引入和使用 uni-ui 引入和使用 vuex   day2 小兔仙项目介绍 - 6 运行小兔鲜项目 项目准备 - 为@添加代码">
<meta property="og:type" content="article">
<meta property="og:title" content="complete Uniapp demo">
<meta property="og:url" content="https://1999zaz.github.io/2022/07/17/uniapp-rabbit-hefei/index.html">
<meta property="og:site_name" content="Zygb的Blog">
<meta property="og:description" content="uniapp-rabbit目录 uniapp-rabbit 目录 day1 使用 vuecli 创建 uniapp项目 运行和预览uniapp项目 开发的规范 项目目录结构 uniapp生命周期 开发的注意事项 开发的规范小结：   uniapp的api easycom 引入和使用 uni-ui 引入和使用 vuex   day2 小兔仙项目介绍 - 6 运行小兔鲜项目 项目准备 - 为@添加代码">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="og:image" content="https://1999zaz.github.io/img/404.jpg">
<meta property="article:published_time" content="2022-07-17T20:25:43.000Z">
<meta property="article:modified_time" content="2023-05-22T01:45:24.862Z">
<meta property="article:author" content="张鱼锅巴">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://1999zaz.github.io/img/404.jpg">


<title >complete Uniapp demo</title>

<!-- Favicon -->

    <link href='/favicon-16x16.png?v=2.0.5' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/favicon-32x32.png?v=2.0.5' rel='icon' type='image/png' sizes='32x32' ></link>




<!-- Plugin -->




    
<link rel="stylesheet" href="/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css">

    
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css">

    
    




<!-- Icon -->

    
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"1999zaz.github.io","author":"张鱼锅巴","root":"/","typed_text":["万事胜意"],"theme_version":"2.0.5","theme":{"switch":true,"default":"style-light"},"favicon":{"logo":"/img/favicon.svg","icon16":"favicon-16x16.png","icon32":"favicon-32x32.png","appleTouchIcon":null,"webmanifest":null,"visibilitychange":true,"hidden":"/failure.ico","showText":"(/≧▽≦/)Hey! Good again!","hideText":"(●—●)Oh, crash!"},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms","author":"Post author: ","copyright_link":"Post link: ","copyright_license_title":"Copyright Notice: ","copyright_license_content":"All articles in this blog are licensed under undefined unless otherwise stated.","copy_success":"Copied","copy_failure":"Copy failed","open_read_mode":"Enter reading mode","exit_read_mode":"Exit reading mode","notice_outdate_message":"It has been undefined days since the last update, the content of the article may be outdated.","just":"Just","min":"minutes ago","hour":"hours ago","day":"days ago","month":"months ago"},"swup":true,"plugin":{"flickr_justified_gallery":"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"far fa-clock","user":"far fa-user","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","user_tag":"fas fa-user-alt","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h","double_arrows":"fas fa-angle-double-down","copy":"fas fa-copy"},"icontype":"font","highlight":{"plugin":"highlighjs","theme":true,"copy":true,"lang":true,"title":"mac","height_limit":200},"covers":["/img/block.jpg"],"creative_commons":{"license":"by-nc-sa","language":"deed.zh"},"search":{"enable":true,"type":"local","href":"https://www.google.com/search?q=site:","domain":null,"preload":true,"trigger":"auto"}};</script>
<script id="async-page-config">window.PAGE_CONFIG = {"isPost":true,"isHome":false,"postUpdate":"2023-05-22 01:45:24"};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/css/index.css?v=2.0.5" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    
    



<!-- Site Analytics -->
 
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" data-scroll-container style="opacity: 0">
          <div data-scroll-section id="content" class="trm-scroll-section">

            <div class="locomotive-scroll__sticky-target" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none;"></div>

            <!-- top bar -->
            <header class="trm-top-bar" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
<a href="/" class="trm-logo-frame trm-anima-link">
    
        <img alt="logo" src="/img/favicon.svg">
    
    
        <div class="trm-logo-text">
            张鱼<span>锅巴</span>
        </div>
    
</a>
<!-- logo end -->
		</div>
		<div class="trm-right-side">
			<!-- menu -->
<div class="trm-menu">
    <nav>
        <ul>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    Home
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/archives/" target="">
                    🌞光荣进化
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/links/" target="">
                    🎃Link
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/about/" target="">
                    🤸About
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/gallery/" target="">
                    📸相册
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>
<!-- menu end -->
			
    <!-- mode switcher place -->
    <div class="trm-mode-switcher-place">
        <div class="trm-mode-switcher">
            <i class="iconfont far fa-sun"></i>
            <input class="tgl tgl-light" id="trm-swich" type="checkbox">
            <label class="trm-swich" for="trm-swich"></label>
            <i class="iconfont far fa-moon"></i>
        </div>
    </div>
    <!-- mode switcher place end -->

			
    
    <div id="trm-search-btn" class="trm-search-btn">
        <i class="iconfont fas fa-search"></i>
    </div>
     

		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner" data-scroll data-scroll-direction="vertical">
    
    <!-- banner cover -->
    <img style="object-position:top;object-fit:cover;" alt="banner" class="trm-banner-cover" data-scroll data-scroll-direction="vertical" data-scroll-speed="-3" src="https://pic1.zhimg.com/v2-b3c2c6745b9421a13a3c4706b19223b3_r.jpg">
    <!-- banner cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container" data-scroll data-scroll-direction="vertical" data-scroll-speed="0">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            NEWS LETTER
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            complete Uniapp demo
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        2022
                                    </span
                                ></li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <a href="#about-triger" data-scroll-to="#about-triger" data-scroll-offset="-130" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </a>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div id="page-sidebar" class="col-lg-4 hidden-sm">
                    <!-- main card -->
                    

<div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card" data-scroll data-scroll-repeat data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="60"> 
    
        <div class="trm-user-tabs" id="sidebar-tabs">
           <div class="trm-tabs-nav trm-mb-40" id="trm-tabs-nav">
                <div data-to="tabs-user" class="trm-tabs-nav-item">
                    <i class="iconfont fas fa-user-alt"></i>
                </div>
                <div data-to="tabs-toc" class="trm-tabs-nav-item active">
                    <i class="iconfont fas fa-th-list"></i>
                </div>
           </div>
            <div name="tabs-user" class="trm-tabs-item">
                <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/img/avatar.jpg">
    </div>
    <h5 class="trm-name trm-mb-15">
        张鱼锅巴
    </h5>
    
        <div class="trm-label">
            2023
            <span class="trm-typed-text">
                <!-- Words for theme.user.typedText -->
            </span>
        </div>
    
</div>
<!-- card header end -->
                <!-- sidebar social -->

<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<div class="trm-social">
    
        <a href="https://github.com/1999zaz" title="Github" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-github"></i>
        </a>
    
        <a href="/" title="Alipay" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-alipay"></i>
        </a>
    
        <a href="/" title="Weixin" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-weixin"></i>
        </a>
    
</div>

<!-- sidebar social end -->
                <!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                地址:
            </div>
            <div class="trm-label trm-label-light">
                安徽
            </div>
        </li>
    
        <li>
            <div class="trm-label">
                年龄:
            </div>
            <div class="trm-label trm-label-light">
                18 forever
            </div>
        </li>
    
        <li>
            <div class="trm-label">
                Hobby:
            </div>
            <div class="trm-label trm-label-light">
                美食与宅与play
            </div>
        </li>
    
        <li>
            <div class="trm-label">
                才华:
            </div>
            <div class="trm-label trm-label-light">
                才高八斗,共有八百斗!!
            </div>
        </li>
    
</ul>
<!-- info end -->

                
    <div class="trm-divider trm-mb-40 trm-mt-40"></div>
    <!-- action button -->
    <div class="text-center">
        <a href="mailto:1120306825@qq.com" class="trm-btn">
            Contact Me
            <i class="iconfont far fa-envelope"></i>
        </a>
    </div>
    <!-- action button end -->

            </div>
            <div name="tabs-toc" class="trm-tabs-item active">
                <div class="post-toc">
    <ol class="toc"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#使用-vuecli-创建-uniapp项目"  data-scroll-to="#使用-vuecli-创建-uniapp项目"><span class="toc-number">1.</span> <span class="toc-text">使用 vuecli 创建 uniapp项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#运行和预览uniapp项目"  data-scroll-to="#运行和预览uniapp项目"><span class="toc-number">2.</span> <span class="toc-text">运行和预览uniapp项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#开发的规范"  data-scroll-to="#开发的规范"><span class="toc-number">3.</span> <span class="toc-text">开发的规范</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#项目目录结构"  data-scroll-to="#项目目录结构"><span class="toc-number">4.</span> <span class="toc-text">项目目录结构</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#uniapp生命周期"  data-scroll-to="#uniapp生命周期"><span class="toc-number">5.</span> <span class="toc-text">uniapp生命周期</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#开发的注意事项"  data-scroll-to="#开发的注意事项"><span class="toc-number">6.</span> <span class="toc-text">开发的注意事项</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#开发的规范小结：-amp-x20"  data-scroll-to="#开发的规范小结：-amp-x20"><span class="toc-number">7.</span> <span class="toc-text">开发的规范小结： &amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#uniapp的api"  data-scroll-to="#uniapp的api"><span class="toc-number">8.</span> <span class="toc-text">uniapp的api</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#easycom"  data-scroll-to="#easycom"><span class="toc-number">9.</span> <span class="toc-text">easycom</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#引入和使用-uni-ui"  data-scroll-to="#引入和使用-uni-ui"><span class="toc-number">10.</span> <span class="toc-text">引入和使用 uni-ui</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#引入和使用-vuex"  data-scroll-to="#引入和使用-vuex"><span class="toc-number">11.</span> <span class="toc-text">引入和使用 vuex</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#小兔仙项目介绍-6"  data-scroll-to="#小兔仙项目介绍-6"><span class="toc-number">12.</span> <span class="toc-text">小兔仙项目介绍 - 6</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#运行小兔鲜项目"  data-scroll-to="#运行小兔鲜项目"><span class="toc-number">13.</span> <span class="toc-text">运行小兔鲜项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#项目准备-为-添加代码提示和插件"  data-scroll-to="#项目准备-为-添加代码提示和插件"><span class="toc-number">14.</span> <span class="toc-text">项目准备 - 为@添加代码提示和插件</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#vuex-复习-state和getters的使用-8"  data-scroll-to="#vuex-复习-state和getters的使用-8"><span class="toc-number">15.</span> <span class="toc-text">vuex-复习-state和getters的使用-8</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#vuex-复习-mutations"  data-scroll-to="#vuex-复习-mutations"><span class="toc-number">16.</span> <span class="toc-text">vuex-复习-mutations</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#vuex-复习-actions"  data-scroll-to="#vuex-复习-actions"><span class="toc-number">17.</span> <span class="toc-text">vuex-复习-actions</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#引进和使用vuex的持久化"  data-scroll-to="#引进和使用vuex的持久化"><span class="toc-number">18.</span> <span class="toc-text">引进和使用vuex的持久化</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#添加拦截器-课程md复制即可"  data-scroll-to="#添加拦截器-课程md复制即可"><span class="toc-number">19.</span> <span class="toc-text">添加拦截器 - 课程md复制即可</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#测试拦截器"  data-scroll-to="#测试拦截器"><span class="toc-number">20.</span> <span class="toc-text">测试拦截器</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#tabbar搭建"  data-scroll-to="#tabbar搭建"><span class="toc-number">21.</span> <span class="toc-text">tabbar搭建</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#自定义导航栏"  data-scroll-to="#自定义导航栏"><span class="toc-number">22.</span> <span class="toc-text">自定义导航栏</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#安全区域-top代表安全区域起点"  data-scroll-to="#安全区域-top代表安全区域起点"><span class="toc-number">23.</span> <span class="toc-text">安全区域 - top代表安全区域起点</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#胶囊的安全区域-top代表胶囊安全区域起点"  data-scroll-to="#胶囊的安全区域-top代表胶囊安全区域起点"><span class="toc-number">24.</span> <span class="toc-text">胶囊的安全区域 - top代表胶囊安全区域起点</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#使用vuex完成顶部导航栏"  data-scroll-to="#使用vuex完成顶部导航栏"><span class="toc-number">25.</span> <span class="toc-text">使用vuex完成顶部导航栏</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#获取主页的banners"  data-scroll-to="#获取主页的banners"><span class="toc-number">26.</span> <span class="toc-text">获取主页的banners</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#banner高度设置"  data-scroll-to="#banner高度设置"><span class="toc-number">27.</span> <span class="toc-text">banner高度设置</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#分类栏目"  data-scroll-to="#分类栏目"><span class="toc-number">28.</span> <span class="toc-text">分类栏目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#栏目的滑动效果"  data-scroll-to="#栏目的滑动效果"><span class="toc-number">29.</span> <span class="toc-text">栏目的滑动效果</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#人气推荐"  data-scroll-to="#人气推荐"><span class="toc-number">30.</span> <span class="toc-text">人气推荐</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#页面滚动"  data-scroll-to="#页面滚动"><span class="toc-number">31.</span> <span class="toc-text">页面滚动</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#新鲜好物和热门品牌"  data-scroll-to="#新鲜好物和热门品牌"><span class="toc-number">32.</span> <span class="toc-text">新鲜好物和热门品牌</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#猜你喜欢-列表正常渲染"  data-scroll-to="#猜你喜欢-列表正常渲染"><span class="toc-number">33.</span> <span class="toc-text">猜你喜欢-列表正常渲染</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#接口小建议"  data-scroll-to="#接口小建议"><span class="toc-number">34.</span> <span class="toc-text">接口小建议</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#猜你喜欢-分页"  data-scroll-to="#猜你喜欢-分页"><span class="toc-number">35.</span> <span class="toc-text">猜你喜欢 - 分页</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#优化-添加节流-6"  data-scroll-to="#优化-添加节流-6"><span class="toc-number">36.</span> <span class="toc-text">优化- 添加节流-6</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#用户底部反馈-6"  data-scroll-to="#用户底部反馈-6"><span class="toc-number">37.</span> <span class="toc-text">用户底部反馈-6</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#下拉刷新-10"  data-scroll-to="#下拉刷新-10"><span class="toc-number">38.</span> <span class="toc-text">下拉刷新-10</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#下拉刷新状态"  data-scroll-to="#下拉刷新状态"><span class="toc-number">39.</span> <span class="toc-text">下拉刷新状态</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#补充-Promise-all"  data-scroll-to="#补充-Promise-all"><span class="toc-number">40.</span> <span class="toc-text">补充-Promise.all</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#下拉刷新完成-注意async会把函数返回值直接变为-promise对象"  data-scroll-to="#下拉刷新完成-注意async会把函数返回值直接变为-promise对象"><span class="toc-number">41.</span> <span class="toc-text">下拉刷新完成-注意async会把函数返回值直接变为 promise对象</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#推荐页面静态结构-全部在文档CV"  data-scroll-to="#推荐页面静态结构-全部在文档CV"><span class="toc-number">42.</span> <span class="toc-text">推荐页面静态结构-全部在文档CV</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#动态设置页面标题"  data-scroll-to="#动态设置页面标题"><span class="toc-number">43.</span> <span class="toc-text">动态设置页面标题</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#获取当前页面的数据"  data-scroll-to="#获取当前页面的数据"><span class="toc-number">44.</span> <span class="toc-text">获取当前页面的数据</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#数据加工处理-解决返回数据无法直接遍历-后台接口已改，不用再处理"  data-scroll-to="#数据加工处理-解决返回数据无法直接遍历-后台接口已改，不用再处理"><span class="toc-number">45.</span> <span class="toc-text">数据加工处理-解决返回数据无法直接遍历 - 后台接口已改，不用再处理</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#页面数据渲染-12"  data-scroll-to="#页面数据渲染-12"><span class="toc-number">46.</span> <span class="toc-text">页面数据渲染-12</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#推荐的分页请求"  data-scroll-to="#推荐的分页请求"><span class="toc-number">47.</span> <span class="toc-text">推荐的分页请求</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#数据追加"  data-scroll-to="#数据追加"><span class="toc-number">48.</span> <span class="toc-text">数据追加</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#优化-节流"  data-scroll-to="#优化-节流"><span class="toc-number">49.</span> <span class="toc-text">优化 - 节流</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#优化-用户底部"  data-scroll-to="#优化-用户底部"><span class="toc-number">50.</span> <span class="toc-text">优化 - 用户底部</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#分类-渲染一级分类"  data-scroll-to="#分类-渲染一级分类"><span class="toc-number">51.</span> <span class="toc-text">分类-渲染一级分类</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#分类-轮播图"  data-scroll-to="#分类-轮播图"><span class="toc-number">52.</span> <span class="toc-text">分类-轮播图</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#二级分类渲染"  data-scroll-to="#二级分类渲染"><span class="toc-number">53.</span> <span class="toc-text">二级分类渲染</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#我的模块"  data-scroll-to="#我的模块"><span class="toc-number">54.</span> <span class="toc-text">我的模块</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#我的模块其他模块"  data-scroll-to="#我的模块其他模块"><span class="toc-number">55.</span> <span class="toc-text">我的模块其他模块</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#使用小程序自带方法获取加密手机号"  data-scroll-to="#使用小程序自带方法获取加密手机号"><span class="toc-number">56.</span> <span class="toc-text">使用小程序自带方法获取加密手机号</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#通过wx-login获取用户code"  data-scroll-to="#通过wx-login获取用户code"><span class="toc-number">57.</span> <span class="toc-text">通过wx.login获取用户code</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#完成手机号登录"  data-scroll-to="#完成手机号登录"><span class="toc-number">58.</span> <span class="toc-text">完成手机号登录</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#手机号模拟登录-可以看到登录效果"  data-scroll-to="#手机号模拟登录-可以看到登录效果"><span class="toc-number">59.</span> <span class="toc-text">手机号模拟登录 - 可以看到登录效果</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#将登陆移植到vuex"  data-scroll-to="#将登陆移植到vuex"><span class="toc-number">60.</span> <span class="toc-text">将登陆移植到vuex</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#登录成功-返回上一页，显示用户数据"  data-scroll-to="#登录成功-返回上一页，显示用户数据"><span class="toc-number">61.</span> <span class="toc-text">登录成功-返回上一页，显示用户数据</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息静态结构-6"  data-scroll-to="#修改个人信息静态结构-6"><span class="toc-number">62.</span> <span class="toc-text">修改个人信息静态结构-6</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#获取个人信息-token处理-7"  data-scroll-to="#获取个人信息-token处理-7"><span class="toc-number">63.</span> <span class="toc-text">获取个人信息-token处理 - 7</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息页面-onLoad-改成-onShow"  data-scroll-to="#修改个人信息页面-onLoad-改成-onShow"><span class="toc-number">64.</span> <span class="toc-text">修改个人信息页面 - onLoad 改成 onShow</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息-选择个人头像"  data-scroll-to="#修改个人信息-选择个人头像"><span class="toc-number">65.</span> <span class="toc-text">修改个人信息 - 选择个人头像</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息-修改个人头像-13"  data-scroll-to="#修改个人信息-修改个人头像-13"><span class="toc-number">66.</span> <span class="toc-text">修改个人信息 - 修改个人头像 - 13</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息-昵称性别出生"  data-scroll-to="#修改个人信息-昵称性别出生"><span class="toc-number">67.</span> <span class="toc-text">修改个人信息 - 昵称性别出生</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#使用dayjs完成日期格式化"  data-scroll-to="#使用dayjs完成日期格式化"><span class="toc-number">68.</span> <span class="toc-text">使用dayjs完成日期格式化</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息-地址选择"  data-scroll-to="#修改个人信息-地址选择"><span class="toc-number">69.</span> <span class="toc-text">修改个人信息 - 地址选择</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#修改个人信息"  data-scroll-to="#修改个人信息"><span class="toc-number">70.</span> <span class="toc-text">修改个人信息</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#我的页面同步信息"  data-scroll-to="#我的页面同步信息"><span class="toc-number">71.</span> <span class="toc-text">我的页面同步信息</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#账号管理-静态结构"  data-scroll-to="#账号管理-静态结构"><span class="toc-number">72.</span> <span class="toc-text">账号管理-静态结构</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#地址管理-静态结构"  data-scroll-to="#地址管理-静态结构"><span class="toc-number">73.</span> <span class="toc-text">地址管理-静态结构</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#新建地址-静态结构和数据分析"  data-scroll-to="#新建地址-静态结构和数据分析"><span class="toc-number">74.</span> <span class="toc-text">新建地址 - 静态结构和数据分析</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#新建地址完成-12"  data-scroll-to="#新建地址完成-12"><span class="toc-number">75.</span> <span class="toc-text">新建地址完成 - 12</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#收货地址列表渲染"  data-scroll-to="#收货地址列表渲染"><span class="toc-number">76.</span> <span class="toc-text">收货地址列表渲染</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#收货地址修改"  data-scroll-to="#收货地址修改"><span class="toc-number">77.</span> <span class="toc-text">收货地址修改</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#删除收货地址"  data-scroll-to="#删除收货地址"><span class="toc-number">78.</span> <span class="toc-text">删除收货地址</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品详情-介绍和页面静态结构"  data-scroll-to="#商品详情-介绍和页面静态结构"><span class="toc-number">79.</span> <span class="toc-text">商品详情-介绍和页面静态结构</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#自定义返回按钮"  data-scroll-to="#自定义返回按钮"><span class="toc-number">80.</span> <span class="toc-text">自定义返回按钮</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#获取商品详情数据"  data-scroll-to="#获取商品详情数据"><span class="toc-number">81.</span> <span class="toc-text">获取商品详情数据</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#轮播图-amp-x20"  data-scroll-to="#轮播图-amp-x20"><span class="toc-number">82.</span> <span class="toc-text">轮播图&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#规格参数"  data-scroll-to="#规格参数"><span class="toc-number">83.</span> <span class="toc-text">规格参数</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品评价、商品详情、常见问题-amp-x20"  data-scroll-to="#商品评价、商品详情、常见问题-amp-x20"><span class="toc-number">84.</span> <span class="toc-text">商品评价、商品详情、常见问题&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品详情整页面cv"  data-scroll-to="#商品详情整页面cv"><span class="toc-number">85.</span> <span class="toc-text">商品详情整页面cv</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品详情-相关推荐和用户操作"  data-scroll-to="#商品详情-相关推荐和用户操作"><span class="toc-number">86.</span> <span class="toc-text">商品详情-相关推荐和用户操作</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品详情-弹出层-对应4个小组件"  data-scroll-to="#商品详情-弹出层-对应4个小组件"><span class="toc-number">87.</span> <span class="toc-text">商品详情-弹出层-对应4个小组件</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#弹出层实现"  data-scroll-to="#弹出层实现"><span class="toc-number">88.</span> <span class="toc-text">弹出层实现</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#sku概念-最小库存单位"  data-scroll-to="#sku概念-最小库存单位"><span class="toc-number">89.</span> <span class="toc-text">sku概念-最小库存单位</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#sku算法了解-2018阿里面试题-原理讲出来就可以进阿里了"  data-scroll-to="#sku算法了解-2018阿里面试题-原理讲出来就可以进阿里了"><span class="toc-number">90.</span> <span class="toc-text">sku算法了解 - 2018阿里面试题 - 原理讲出来就可以进阿里了</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#sku插件下载和引用"  data-scroll-to="#sku插件下载和引用"><span class="toc-number">91.</span> <span class="toc-text">sku插件下载和引用</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#sku关键属性介绍"  data-scroll-to="#sku关键属性介绍"><span class="toc-number">92.</span> <span class="toc-text">sku关键属性介绍</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#sku复制官网demo看效果"  data-scroll-to="#sku复制官网demo看效果"><span class="toc-number">93.</span> <span class="toc-text">sku复制官网demo看效果</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#官网demo数据和后台数据一一对应"  data-scroll-to="#官网demo数据和后台数据一一对应"><span class="toc-number">94.</span> <span class="toc-text">官网demo数据和后台数据一一对应</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#根据官网文档，把后台数据处理成合适的数据"  data-scroll-to="#根据官网文档，把后台数据处理成合适的数据"><span class="toc-number">95.</span> <span class="toc-text">根据官网文档，把后台数据处理成合适的数据</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#完善商品sku的三个小功能"  data-scroll-to="#完善商品sku的三个小功能"><span class="toc-number">96.</span> <span class="toc-text">完善商品sku的三个小功能</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#加入购物车"  data-scroll-to="#加入购物车"><span class="toc-number">97.</span> <span class="toc-text">加入购物车</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#对象解构和重命名"  data-scroll-to="#对象解构和重命名"><span class="toc-number">98.</span> <span class="toc-text">对象解构和重命名</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#跳转购物车-跳转tabbar-使用-switchTab"  data-scroll-to="#跳转购物车-跳转tabbar-使用-switchTab"><span class="toc-number">99.</span> <span class="toc-text">跳转购物车 - 跳转tabbar 使用 switchTab</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#购物车列表和登录状态"  data-scroll-to="#购物车列表和登录状态"><span class="toc-number">100.</span> <span class="toc-text">购物车列表和登录状态</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#未登录状态下会跳转登录页的处理"  data-scroll-to="#未登录状态下会跳转登录页的处理"><span class="toc-number">101.</span> <span class="toc-text">未登录状态下会跳转登录页的处理</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品状态的修改"  data-scroll-to="#商品状态的修改"><span class="toc-number">102.</span> <span class="toc-text">商品状态的修改</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#商品数量的修改"  data-scroll-to="#商品数量的修改"><span class="toc-number">103.</span> <span class="toc-text">商品数量的修改</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#使用uniapp内置组件完成数量修改-amp-x20"  data-scroll-to="#使用uniapp内置组件完成数量修改-amp-x20"><span class="toc-number">104.</span> <span class="toc-text">使用uniapp内置组件完成数量修改&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#勾选商品的总数量和总价格-amp-x20"  data-scroll-to="#勾选商品的总数量和总价格-amp-x20"><span class="toc-number">105.</span> <span class="toc-text">勾选商品的总数量和总价格&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#计算全选状态"  data-scroll-to="#计算全选状态"><span class="toc-number">106.</span> <span class="toc-text">计算全选状态</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#全选和反选-amp-x20"  data-scroll-to="#全选和反选-amp-x20"><span class="toc-number">107.</span> <span class="toc-text">全选和反选&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#删除商品-amp-x20"  data-scroll-to="#删除商品-amp-x20"><span class="toc-number">108.</span> <span class="toc-text">删除商品&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#批量删除商品"  data-scroll-to="#批量删除商品"><span class="toc-number">109.</span> <span class="toc-text">批量删除商品</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#跳转订单页"  data-scroll-to="#跳转订单页"><span class="toc-number">110.</span> <span class="toc-text">跳转订单页</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#预付单-发送请求拿回数据"  data-scroll-to="#预付单-发送请求拿回数据"><span class="toc-number">111.</span> <span class="toc-text">预付单 - 发送请求拿回数据</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#订单-获取收货地址，存放到vuex-13"  data-scroll-to="#订单-获取收货地址，存放到vuex-13"><span class="toc-number">112.</span> <span class="toc-text">订单 - 获取收货地址，存放到vuex-13</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#地址选择-返回上一页的优化"  data-scroll-to="#地址选择-返回上一页的优化"><span class="toc-number">113.</span> <span class="toc-text">地址选择-返回上一页的优化</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#创建预付单"  data-scroll-to="#创建预付单"><span class="toc-number">114.</span> <span class="toc-text">创建预付单</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#跳转订单详情页-带上orderId"  data-scroll-to="#跳转订单详情页-带上orderId"><span class="toc-number">115.</span> <span class="toc-text">跳转订单详情页-带上orderId</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#购物车立即下单跳转预付单-8"  data-scroll-to="#购物车立即下单跳转预付单-8"><span class="toc-number">116.</span> <span class="toc-text">购物车立即下单跳转预付单-8</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#订单-顶部导航栏-获取设备平台"  data-scroll-to="#订单-顶部导航栏-获取设备平台"><span class="toc-number">117.</span> <span class="toc-text">订单-顶部导航栏-获取设备平台</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#获取订单详情"  data-scroll-to="#获取订单详情"><span class="toc-number">118.</span> <span class="toc-text">获取订单详情</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#订单状态渲染"  data-scroll-to="#订单状态渲染"><span class="toc-number">119.</span> <span class="toc-text">订单状态渲染</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#时间格式化"  data-scroll-to="#时间格式化"><span class="toc-number">120.</span> <span class="toc-text">时间格式化</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#倒计时"  data-scroll-to="#倒计时"><span class="toc-number">121.</span> <span class="toc-text">倒计时</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#支付功能实现"  data-scroll-to="#支付功能实现"><span class="toc-number">122.</span> <span class="toc-text">支付功能实现</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#订单状态，订单列表在md文档复制完成-amp-x20"  data-scroll-to="#订单状态，订单列表在md文档复制完成-amp-x20"><span class="toc-number">123.</span> <span class="toc-text">订单状态，订单列表在md文档复制完成&amp;#x20;</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#uniapp-hbuildx"  data-scroll-to="#uniapp-hbuildx"><span class="toc-number">124.</span> <span class="toc-text">uniapp - hbuildx</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#新建项目"  data-scroll-to="#新建项目"><span class="toc-number">125.</span> <span class="toc-text">新建项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#运行项目"  data-scroll-to="#运行项目"><span class="toc-number">126.</span> <span class="toc-text">运行项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#运行时可能出现的问题"  data-scroll-to="#运行时可能出现的问题"><span class="toc-number">127.</span> <span class="toc-text">运行时可能出现的问题</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#打包项目"  data-scroll-to="#打包项目"><span class="toc-number">128.</span> <span class="toc-text">打包项目</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#打包可能出现的问题"  data-scroll-to="#打包可能出现的问题"><span class="toc-number">129.</span> <span class="toc-text">打包可能出现的问题</span></a></li></ol>
</div>
            </div>
        </div>
    
    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div id="page-content" class="col-lg-8">
                <div class="trm-content" id="trm-content">
                    <div data-scroll data-scroll-repeat data-scroll-offset="500" id="about-triger"></div>

                    <div id="post-info" class="row hidden-sm">
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-calendar-alt trm-icon"></i><br>
            07/17
        </div>
    </div>
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-clock trm-icon"></i><br>
            20:25
        </div>
    </div>
    <div class="col-sm-4">
        <div id="post-author" class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-user trm-icon"></i><br>
            张鱼锅巴
        </div>
    </div>
</div>
<div class="trm-card ">
    <article id="article-container" class="trm-publication">
    <h1 id="uniapp-rabbit"><a href="#uniapp-rabbit" class="headerlink" title="uniapp-rabbit"></a>uniapp-rabbit</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#uniapp-rabbit">uniapp-rabbit</a><ul>
<li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li>
<li><a href="#day1">day1</a><ul>
<li><a href="#%E4%BD%BF%E7%94%A8-vuecli-%E5%88%9B%E5%BB%BA-uniapp%E9%A1%B9%E7%9B%AE">使用 vuecli 创建 uniapp项目</a></li>
<li><a href="#%E8%BF%90%E8%A1%8C%E5%92%8C%E9%A2%84%E8%A7%88uniapp%E9%A1%B9%E7%9B%AE">运行和预览uniapp项目</a></li>
<li><a href="#%E5%BC%80%E5%8F%91%E7%9A%84%E8%A7%84%E8%8C%83">开发的规范</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">项目目录结构</a></li>
<li><a href="#uniapp%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">uniapp生命周期</a></li>
<li><a href="#%E5%BC%80%E5%8F%91%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">开发的注意事项</a></li>
<li><a href="#%E5%BC%80%E5%8F%91%E7%9A%84%E8%A7%84%E8%8C%83%E5%B0%8F%E7%BB%93--">开发的规范小结：  </a></li>
<li><a href="#uniapp%E7%9A%84api">uniapp的api</a></li>
<li><a href="#easycom">easycom</a></li>
<li><a href="#%E5%BC%95%E5%85%A5%E5%92%8C%E4%BD%BF%E7%94%A8-uni-ui">引入和使用 uni-ui</a></li>
<li><a href="#%E5%BC%95%E5%85%A5%E5%92%8C%E4%BD%BF%E7%94%A8-vuex">引入和使用 vuex</a></li>
</ul>
</li>
<li><a href="#day2">day2</a><ul>
<li><a href="#%E5%B0%8F%E5%85%94%E4%BB%99%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D---6">小兔仙项目介绍 - 6</a></li>
<li><a href="#%E8%BF%90%E8%A1%8C%E5%B0%8F%E5%85%94%E9%B2%9C%E9%A1%B9%E7%9B%AE">运行小兔鲜项目</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E5%87%86%E5%A4%87---%E4%B8%BA%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81%E6%8F%90%E7%A4%BA%E5%92%8C%E6%8F%92%E4%BB%B6">项目准备 - 为@添加代码提示和插件</a></li>
<li><a href="#vuex-%E5%A4%8D%E4%B9%A0-state%E5%92%8Cgetters%E7%9A%84%E4%BD%BF%E7%94%A8-8">vuex-复习-state和getters的使用-8</a></li>
<li><a href="#vuex-%E5%A4%8D%E4%B9%A0-mutations">vuex-复习-mutations</a></li>
<li><a href="#vuex-%E5%A4%8D%E4%B9%A0-actions">vuex-复习-actions</a></li>
<li><a href="#%E5%BC%95%E8%BF%9B%E5%92%8C%E4%BD%BF%E7%94%A8vuex%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96">引进和使用vuex的持久化</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E6%8B%A6%E6%88%AA%E5%99%A8---%E8%AF%BE%E7%A8%8Bmd%E5%A4%8D%E5%88%B6%E5%8D%B3%E5%8F%AF">添加拦截器 - 课程md复制即可</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95%E6%8B%A6%E6%88%AA%E5%99%A8">测试拦截器</a></li>
<li><a href="#tabbar%E6%90%AD%E5%BB%BA">tabbar搭建</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E8%88%AA%E6%A0%8F">自定义导航栏</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F---top%E4%BB%A3%E8%A1%A8%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F%E8%B5%B7%E7%82%B9">安全区域 - top代表安全区域起点</a></li>
<li><a href="#%E8%83%B6%E5%9B%8A%E7%9A%84%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F---top%E4%BB%A3%E8%A1%A8%E8%83%B6%E5%9B%8A%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F%E8%B5%B7%E7%82%B9">胶囊的安全区域 - top代表胶囊安全区域起点</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8vuex%E5%AE%8C%E6%88%90%E9%A1%B6%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F">使用vuex完成顶部导航栏</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E4%B8%BB%E9%A1%B5%E7%9A%84banners">获取主页的banners</a></li>
<li><a href="#banner%E9%AB%98%E5%BA%A6%E8%AE%BE%E7%BD%AE">banner高度设置</a></li>
<li><a href="#%E5%88%86%E7%B1%BB%E6%A0%8F%E7%9B%AE">分类栏目</a></li>
<li><a href="#%E6%A0%8F%E7%9B%AE%E7%9A%84%E6%BB%91%E5%8A%A8%E6%95%88%E6%9E%9C">栏目的滑动效果</a></li>
<li><a href="#%E4%BA%BA%E6%B0%94%E6%8E%A8%E8%8D%90">人气推荐</a></li>
<li><a href="#%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8">页面滚动</a></li>
<li><a href="#%E6%96%B0%E9%B2%9C%E5%A5%BD%E7%89%A9%E5%92%8C%E7%83%AD%E9%97%A8%E5%93%81%E7%89%8C">新鲜好物和热门品牌</a></li>
<li><a href="#%E7%8C%9C%E4%BD%A0%E5%96%9C%E6%AC%A2-%E5%88%97%E8%A1%A8%E6%AD%A3%E5%B8%B8%E6%B8%B2%E6%9F%93">猜你喜欢-列表正常渲染</a></li>
<li><a href="#%E6%8E%A5%E5%8F%A3%E5%B0%8F%E5%BB%BA%E8%AE%AE">接口小建议</a></li>
<li><a href="#%E7%8C%9C%E4%BD%A0%E5%96%9C%E6%AC%A2---%E5%88%86%E9%A1%B5">猜你喜欢 - 分页</a></li>
<li><a href="#%E4%BC%98%E5%8C%96--%E6%B7%BB%E5%8A%A0%E8%8A%82%E6%B5%81-6">优化- 添加节流-6</a></li>
<li><a href="#%E7%94%A8%E6%88%B7%E5%BA%95%E9%83%A8%E5%8F%8D%E9%A6%88-6">用户底部反馈-6</a></li>
</ul>
</li>
<li><a href="#day3">day3</a><ul>
<li><a href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0-10">下拉刷新-10</a></li>
<li><a href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E7%8A%B6%E6%80%81">下拉刷新状态</a></li>
<li><a href="#%E8%A1%A5%E5%85%85-promiseall">补充-Promise.all</a></li>
<li><a href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E5%AE%8C%E6%88%90-%E6%B3%A8%E6%84%8Fasync%E4%BC%9A%E6%8A%8A%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9B%B4%E6%8E%A5%E5%8F%98%E4%B8%BA-promise%E5%AF%B9%E8%B1%A1">下拉刷新完成-注意async会把函数返回值直接变为 promise对象</a></li>
<li><a href="#%E6%8E%A8%E8%8D%90%E9%A1%B5%E9%9D%A2%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-%E5%85%A8%E9%83%A8%E5%9C%A8%E6%96%87%E6%A1%A3cv">推荐页面静态结构-全部在文档CV</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%E9%A1%B5%E9%9D%A2%E6%A0%87%E9%A2%98">动态设置页面标题</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%95%B0%E6%8D%AE">获取当前页面的数据</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%B7%A5%E5%A4%84%E7%90%86-%E8%A7%A3%E5%86%B3%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E6%97%A0%E6%B3%95%E7%9B%B4%E6%8E%A5%E9%81%8D%E5%8E%86---%E5%90%8E%E5%8F%B0%E6%8E%A5%E5%8F%A3%E5%B7%B2%E6%94%B9%E4%B8%8D%E7%94%A8%E5%86%8D%E5%A4%84%E7%90%86"><del>数据加工处理-解决返回数据无法直接遍历 - 后台接口已改，不用再处理</del></a></li>
<li><a href="#%E9%A1%B5%E9%9D%A2%E6%95%B0%E6%8D%AE%E6%B8%B2%E6%9F%93-12">页面数据渲染-12</a></li>
<li><a href="#%E6%8E%A8%E8%8D%90%E7%9A%84%E5%88%86%E9%A1%B5%E8%AF%B7%E6%B1%82">推荐的分页请求</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E8%BF%BD%E5%8A%A0">数据追加</a></li>
<li><a href="#%E4%BC%98%E5%8C%96---%E8%8A%82%E6%B5%81">优化 - 节流</a></li>
<li><a href="#%E4%BC%98%E5%8C%96---%E7%94%A8%E6%88%B7%E5%BA%95%E9%83%A8">优化 - 用户底部</a></li>
<li><a href="#%E5%88%86%E7%B1%BB-%E6%B8%B2%E6%9F%93%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB">分类-渲染一级分类</a></li>
<li><a href="#%E5%88%86%E7%B1%BB-%E8%BD%AE%E6%92%AD%E5%9B%BE">分类-轮播图</a></li>
<li><a href="#%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB%E6%B8%B2%E6%9F%93">二级分类渲染</a></li>
<li><a href="#%E6%88%91%E7%9A%84%E6%A8%A1%E5%9D%97">我的模块</a></li>
<li><a href="#%E6%88%91%E7%9A%84%E6%A8%A1%E5%9D%97%E5%85%B6%E4%BB%96%E6%A8%A1%E5%9D%97">我的模块其他模块</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%B8%A6%E6%96%B9%E6%B3%95%E8%8E%B7%E5%8F%96%E5%8A%A0%E5%AF%86%E6%89%8B%E6%9C%BA%E5%8F%B7">使用小程序自带方法获取加密手机号</a></li>
<li><a href="#%E9%80%9A%E8%BF%87wxlogin%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7code">通过wx.login获取用户code</a></li>
</ul>
</li>
<li><a href="#day4">day4</a><ul>
<li><a href="#%E5%AE%8C%E6%88%90%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%99%BB%E5%BD%95">完成手机号登录</a></li>
<li><a href="#%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95---%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E7%99%BB%E5%BD%95%E6%95%88%E6%9E%9C">手机号模拟登录 - 可以看到登录效果</a></li>
<li><a href="#%E5%B0%86%E7%99%BB%E9%99%86%E7%A7%BB%E6%A4%8D%E5%88%B0vuex">将登陆移植到vuex</a></li>
<li><a href="#%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F-%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5%E6%98%BE%E7%A4%BA%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE">登录成功-返回上一页，显示用户数据</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-6">修改个人信息静态结构-6</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF-token%E5%A4%84%E7%90%86---7">获取个人信息-token处理 - 7</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF%E9%A1%B5%E9%9D%A2---onload-%E6%94%B9%E6%88%90-onshow">修改个人信息页面 - onLoad 改成 onShow</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF---%E9%80%89%E6%8B%A9%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F">修改个人信息 - 选择个人头像</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF---%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F---13">修改个人信息 - 修改个人头像 - 13</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF---%E6%98%B5%E7%A7%B0%E6%80%A7%E5%88%AB%E5%87%BA%E7%94%9F">修改个人信息 - 昵称性别出生</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8dayjs%E5%AE%8C%E6%88%90%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96">使用dayjs完成日期格式化</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF---%E5%9C%B0%E5%9D%80%E9%80%89%E6%8B%A9">修改个人信息 - 地址选择</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF">修改个人信息</a></li>
<li><a href="#%E6%88%91%E7%9A%84%E9%A1%B5%E9%9D%A2%E5%90%8C%E6%AD%A5%E4%BF%A1%E6%81%AF">我的页面同步信息</a></li>
<li><a href="#%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86-%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84">账号管理-静态结构</a></li>
<li><a href="#%E5%9C%B0%E5%9D%80%E7%AE%A1%E7%90%86-%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84">地址管理-静态结构</a></li>
<li><a href="#%E6%96%B0%E5%BB%BA%E5%9C%B0%E5%9D%80---%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84%E5%92%8C%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">新建地址 - 静态结构和数据分析</a></li>
<li><a href="#%E6%96%B0%E5%BB%BA%E5%9C%B0%E5%9D%80%E5%AE%8C%E6%88%90---12">新建地址完成 - 12</a></li>
<li><a href="#%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93">收货地址列表渲染</a></li>
</ul>
</li>
<li><a href="#day5">day5</a><ul>
<li><a href="#%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80%E4%BF%AE%E6%94%B9">收货地址修改</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80">删除收货地址</a></li>
<li><a href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85-%E4%BB%8B%E7%BB%8D%E5%92%8C%E9%A1%B5%E9%9D%A2%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84">商品详情-介绍和页面静态结构</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE">自定义返回按钮</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E6%95%B0%E6%8D%AE">获取商品详情数据</a></li>
<li><a href="#%E8%BD%AE%E6%92%AD%E5%9B%BE-">轮播图 </a></li>
<li><a href="#%E8%A7%84%E6%A0%BC%E5%8F%82%E6%95%B0">规格参数</a></li>
<li><a href="#%E5%95%86%E5%93%81%E8%AF%84%E4%BB%B7%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-">商品评价、商品详情、常见问题 </a></li>
<li><a href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E6%95%B4%E9%A1%B5%E9%9D%A2cv">商品详情整页面cv</a></li>
<li><a href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85-%E7%9B%B8%E5%85%B3%E6%8E%A8%E8%8D%90%E5%92%8C%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C">商品详情-相关推荐和用户操作</a></li>
<li><a href="#%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85-%E5%BC%B9%E5%87%BA%E5%B1%82-%E5%AF%B9%E5%BA%944%E4%B8%AA%E5%B0%8F%E7%BB%84%E4%BB%B6">商品详情-弹出层-对应4个小组件</a></li>
<li><a href="#%E5%BC%B9%E5%87%BA%E5%B1%82%E5%AE%9E%E7%8E%B0">弹出层实现</a></li>
<li><a href="#sku%E6%A6%82%E5%BF%B5-%E6%9C%80%E5%B0%8F%E5%BA%93%E5%AD%98%E5%8D%95%E4%BD%8D">sku概念-最小库存单位</a></li>
<li><a href="#sku%E7%AE%97%E6%B3%95%E4%BA%86%E8%A7%A3---2018%E9%98%BF%E9%87%8C%E9%9D%A2%E8%AF%95%E9%A2%98---%E5%8E%9F%E7%90%86%E8%AE%B2%E5%87%BA%E6%9D%A5%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%BF%9B%E9%98%BF%E9%87%8C%E4%BA%86">sku算法了解 - 2018阿里面试题 - 原理讲出来就可以进阿里了</a></li>
<li><a href="#sku%E6%8F%92%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%BC%95%E7%94%A8">sku插件下载和引用</a></li>
<li><a href="#sku%E5%85%B3%E9%94%AE%E5%B1%9E%E6%80%A7%E4%BB%8B%E7%BB%8D">sku关键属性介绍</a></li>
<li><a href="#sku%E5%A4%8D%E5%88%B6%E5%AE%98%E7%BD%91demo%E7%9C%8B%E6%95%88%E6%9E%9C">sku复制官网demo看效果</a></li>
<li><a href="#%E5%AE%98%E7%BD%91demo%E6%95%B0%E6%8D%AE%E5%92%8C%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E4%B8%80%E4%B8%80%E5%AF%B9%E5%BA%94">官网demo数据和后台数据一一对应</a></li>
<li><a href="#%E6%A0%B9%E6%8D%AE%E5%AE%98%E7%BD%91%E6%96%87%E6%A1%A3%E6%8A%8A%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%88%90%E5%90%88%E9%80%82%E7%9A%84%E6%95%B0%E6%8D%AE">根据官网文档，把后台数据处理成合适的数据</a></li>
<li><a href="#%E5%AE%8C%E5%96%84%E5%95%86%E5%93%81sku%E7%9A%84%E4%B8%89%E4%B8%AA%E5%B0%8F%E5%8A%9F%E8%83%BD">完善商品sku的三个小功能</a></li>
<li><a href="#%E5%8A%A0%E5%85%A5%E8%B4%AD%E7%89%A9%E8%BD%A6">加入购物车</a></li>
</ul>
</li>
<li><a href="#day6">day6</a><ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E8%A7%A3%E6%9E%84%E5%92%8C%E9%87%8D%E5%91%BD%E5%90%8D">对象解构和重命名</a></li>
<li><a href="#%E8%B7%B3%E8%BD%AC%E8%B4%AD%E7%89%A9%E8%BD%A6---%E8%B7%B3%E8%BD%ACtabbar-%E4%BD%BF%E7%94%A8-switchtab">跳转购物车 - 跳转tabbar 使用 switchTab</a></li>
<li><a href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8%E5%92%8C%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81">购物车列表和登录状态</a></li>
<li><a href="#%E6%9C%AA%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81%E4%B8%8B%E4%BC%9A%E8%B7%B3%E8%BD%AC%E7%99%BB%E5%BD%95%E9%A1%B5%E7%9A%84%E5%A4%84%E7%90%86">未登录状态下会跳转登录页的处理</a></li>
<li><a href="#%E5%95%86%E5%93%81%E7%8A%B6%E6%80%81%E7%9A%84%E4%BF%AE%E6%94%B9">商品状态的修改</a></li>
<li><a href="#%E5%95%86%E5%93%81%E6%95%B0%E9%87%8F%E7%9A%84%E4%BF%AE%E6%94%B9">商品数量的修改</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8uniapp%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6%E5%AE%8C%E6%88%90%E6%95%B0%E9%87%8F%E4%BF%AE%E6%94%B9-">使用uniapp内置组件完成数量修改 </a></li>
<li><a href="#%E5%8B%BE%E9%80%89%E5%95%86%E5%93%81%E7%9A%84%E6%80%BB%E6%95%B0%E9%87%8F%E5%92%8C%E6%80%BB%E4%BB%B7%E6%A0%BC-">勾选商品的总数量和总价格 </a></li>
<li><a href="#%E8%AE%A1%E7%AE%97%E5%85%A8%E9%80%89%E7%8A%B6%E6%80%81">计算全选状态</a></li>
<li><a href="#%E5%85%A8%E9%80%89%E5%92%8C%E5%8F%8D%E9%80%89-">全选和反选 </a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E5%95%86%E5%93%81-">删除商品 </a></li>
<li><a href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E5%95%86%E5%93%81">批量删除商品</a></li>
<li><a href="#%E8%B7%B3%E8%BD%AC%E8%AE%A2%E5%8D%95%E9%A1%B5">跳转订单页</a></li>
<li><a href="#%E9%A2%84%E4%BB%98%E5%8D%95---%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E6%8B%BF%E5%9B%9E%E6%95%B0%E6%8D%AE">预付单 - 发送请求拿回数据</a></li>
<li><a href="#%E8%AE%A2%E5%8D%95---%E8%8E%B7%E5%8F%96%E6%94%B6%E8%B4%A7%E5%9C%B0%E5%9D%80%E5%AD%98%E6%94%BE%E5%88%B0vuex-13">订单 - 获取收货地址，存放到vuex-13</a></li>
<li><a href="#%E5%9C%B0%E5%9D%80%E9%80%89%E6%8B%A9-%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5%E7%9A%84%E4%BC%98%E5%8C%96">地址选择-返回上一页的优化</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA%E9%A2%84%E4%BB%98%E5%8D%95">创建预付单</a></li>
<li><a href="#%E8%B7%B3%E8%BD%AC%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85%E9%A1%B5-%E5%B8%A6%E4%B8%8Aorderid">跳转订单详情页-带上orderId</a></li>
<li><a href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%AB%8B%E5%8D%B3%E4%B8%8B%E5%8D%95%E8%B7%B3%E8%BD%AC%E9%A2%84%E4%BB%98%E5%8D%95-8">购物车立即下单跳转预付单-8</a></li>
<li><a href="#%E8%AE%A2%E5%8D%95-%E9%A1%B6%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F-%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E5%B9%B3%E5%8F%B0">订单-顶部导航栏-获取设备平台</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85">获取订单详情</a></li>
<li><a href="#%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E6%B8%B2%E6%9F%93">订单状态渲染</a></li>
<li><a href="#%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96">时间格式化</a></li>
<li><a href="#%E5%80%92%E8%AE%A1%E6%97%B6">倒计时</a></li>
<li><a href="#%E6%94%AF%E4%BB%98%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0">支付功能实现</a></li>
<li><a href="#%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E5%9C%A8md%E6%96%87%E6%A1%A3%E5%A4%8D%E5%88%B6%E5%AE%8C%E6%88%90-">订单状态，订单列表在md文档复制完成 </a></li>
</ul>
</li>
<li><a href="#%E6%89%A9%E5%B1%95">扩展</a><ul>
<li><a href="#uniapp---hbuildx">uniapp - hbuildx</a></li>
<li><a href="#%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE">新建项目</a></li>
<li><a href="#%E8%BF%90%E8%A1%8C%E9%A1%B9%E7%9B%AE">运行项目</a></li>
<li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98">运行时可能出现的问题</a></li>
<li><a href="#%E6%89%93%E5%8C%85%E9%A1%B9%E7%9B%AE">打包项目</a></li>
<li><a href="#%E6%89%93%E5%8C%85%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98">打包可能出现的问题</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="day1"><a href="#day1" class="headerlink" title="day1"></a>day1</h2><h3 id="使用-vuecli-创建-uniapp项目"><a href="#使用-vuecli-创建-uniapp项目" class="headerlink" title="使用 vuecli 创建 uniapp项目"></a>使用 vuecli 创建 uniapp项目</h3><ol>
<li>node版本16，然后安装全局vue&#x2F;cli@4.5.19,千万不要用第5版</li>
<li>脚手架创建项目，vue create -p dcloudio&#x2F;uni-preset-vue my-project</li>
<li>如果是首次创建，选择”默认模板即可”</li>
</ol>
<h3 id="运行和预览uniapp项目"><a href="#运行和预览uniapp项目" class="headerlink" title="运行和预览uniapp项目"></a>运行和预览uniapp项目</h3><ol>
<li>在 manifest.json填入appid</li>
<li>运行 npm run dev:mp-weixin</li>
<li>开发者工具，导入项目，注意路径 “项目地址&#x2F;dist&#x2F;dev&#x2F;mp-weixin”</li>
</ol>
<p><img src="/./image/1676024773411_g6IF3x83q6.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<!-- <img src="/source/img/1676024773411_g6IF3x83q6.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'> -->

<h3 id="开发的规范"><a href="#开发的规范" class="headerlink" title="开发的规范"></a>开发的规范</h3><ol>
<li>不能直接在开发者工具中修改代码，口诀：vscode做开发，开发者工具做调试</li>
<li>标签使用小程序的规范，语法使用vue的即可</li>
</ol>
<h3 id="项目目录结构"><a href="#项目目录结构" class="headerlink" title="项目目录结构"></a>项目目录结构</h3><ol>
<li>App.vue 相等于原生小程序 app.wxss （全局样式文件）和 app.js （应用入口文件）</li>
<li>main.js uniapp 项目入口文件 ，后期有一些设置想全局都生效(vuex)</li>
<li>mainifest.json 相当于小程序 project.config.json 设置 appid 、设置不校验合法域名一微信开发者工具一本地设置的功能</li>
<li>pages.json 相当于以前小程序当中全局配置 app.json 和页面配置 index.json<ol>
<li>新建了页面，需要在 pages.json 中设置页面路径</li>
<li>设置应用的标题还可以设置单个页面的标题</li>
<li>设置导航栏样式</li>
<li>设置 tabbar</li>
</ol>
</li>
<li>uni.scss 全局样式文件，写 scss 语法，默认被 uniapp 引入了，所以不需要手动去引入它</li>
<li>pages 文件夹是否 uniapp 页面文件！！</li>
<li>static 存放静态资源，图片，字体等</li>
</ol>
<h3 id="uniapp生命周期"><a href="#uniapp生命周期" class="headerlink" title="uniapp生命周期"></a>uniapp生命周期</h3><p>口诀：组件生命周期使用vue规范，其他使用小程序规范</p>
<ol>
<li>应用生命周期，使用小程序<ol>
<li>onLauch等</li>
</ol>
</li>
<li>页面生命周期，使用小程序<ol>
<li>onLoad，onShow等</li>
</ol>
</li>
<li>组件生命周期，使用vue的规范<ol>
<li>created，mounted等</li>
</ol>
</li>
</ol>
<h3 id="开发的注意事项"><a href="#开发的注意事项" class="headerlink" title="开发的注意事项"></a>开发的注意事项</h3><p>1. 不要再微信开发者工具中，做任何的修改(包括页面的创建app.json,修改appid) &amp;#x20;</p>
<p>2. 保证vscode的项目时，是有启动服务的 &amp;#x20;</p>
<p>&amp;#x20;</p>
<h3 id="开发的规范小结：-amp-x20"><a href="#开发的规范小结：-amp-x20" class="headerlink" title="开发的规范小结： &amp;#x20;"></a>开发的规范小结： &amp;#x20;</h3><p>1. 标签和应用、页面生命周期，使用小程序规范(view,text,onLoad,onShow) &amp;#x20;</p>
<p>2. 语法和组件的生命周期，使用vue2的语法规范(@clik, mounted)</p>
<h3 id="uniapp的api"><a href="#uniapp的api" class="headerlink" title="uniapp的api"></a>uniapp的api</h3><ol>
<li>wx的api，修改前缀后(uni)，可以直接用 : wx.showToast() —- uni.showToast()</li>
<li>uni支持promise的使用方式<ol>
<li><del>使用promise返回的是数组，建议直接解构使用即可(新版本对返回的数据做了封装，不一定是数组)</del></li>
</ol>
</li>
</ol>
<p><img src="/./image/1676025320592_NXOabHk2n4.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="easycom"><a href="#easycom" class="headerlink" title="easycom"></a>easycom</h3><ol>
<li>按照规范新建组件： components&#x2F;组件名&#x2F;组件名.vue</li>
<li>页面直接使用即可</li>
</ol>
<p><img src="/./image/1676025396979_V_p5eYrY5B.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="引入和使用-uni-ui"><a href="#引入和使用-uni-ui" class="headerlink" title="引入和使用 uni-ui"></a>引入和使用 uni-ui</h3><p>官网：</p>
<ol>
<li>根目录创建vue.config.js 配置需要编译 uni-ui</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">transpileDependencies</span>:[<span class="string">&#x27;@dcloudio/uni-ui&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>安装 npm i sass @dcloudio&#x2F;uni-ui</li>
<li>配置easycom，方便整个项目都能使用到 uni-ui</li>
<li>页面复制代码使用 提示： 因为改过配置，一般都要重新启动项目</li>
</ol>
<p>到了这里，基本语法已经介绍完毕，可以进入项目</p>
<h3 id="引入和使用-vuex"><a href="#引入和使用-vuex" class="headerlink" title="引入和使用 vuex"></a>引入和使用 vuex</h3><p>uniapp官网:<a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/vue3-vuex.html#%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86vuex" title="https://uniapp.dcloud.net.cn/tutorial/vue3-vuex.html#状态管理vuex">https://uniapp.dcloud.net.cn/tutorial/vue3-vuex.html#状态管理vuex</a></p>
<ol>
<li>安装vuex</li>
<li>新建文件 <code>src/store/index.js</code></li>
<li><code>src/main.js</code> 中 引入 <code>store</code></li>
<li>页面引入使用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 页面路径：store/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>); <span class="comment">//vue的插件机制</span></span><br><span class="line"><span class="comment">//Vuex.Store 构造器选项</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;<span class="attr">username</span>:<span class="string">&#x27;zs&#x27;</span>&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">modules</span>: &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/main.js 中 引入 store</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  store,</span><br><span class="line">  ...<span class="title class_">App</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;username&#x27;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; username &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="day2"><a href="#day2" class="headerlink" title="day2"></a>day2</h2><h3 id="小兔仙项目介绍-6"><a href="#小兔仙项目介绍-6" class="headerlink" title="小兔仙项目介绍 - 6"></a>小兔仙项目介绍 - 6</h3><p>与md文档一致</p>
<h3 id="运行小兔鲜项目"><a href="#运行小兔鲜项目" class="headerlink" title="运行小兔鲜项目"></a>运行小兔鲜项目</h3><ol>
<li>把老师发的”小兔鲜项目代码-项目结构”代码复制</li>
<li>进入项目，安装依赖</li>
<li>在 manifest.json(大概57行)修改自己的 appid</li>
<li>运行 npm run dev:mp-weixin</li>
<li>开发者工具中，导入项目（不选择云服务），注意路径是 项目地址&#x2F;dist&#x2F;dev&#x2F;mp-weixin</li>
<li>能看到导航条出来就ok</li>
<li>未雨绸缪：npm i vuex和 npm i vuex-uniapp-persistence</li>
</ol>
<p><img src="/./image/image_361d_IrIW5.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="项目准备-为-添加代码提示和插件"><a href="#项目准备-为-添加代码提示和插件" class="headerlink" title="项目准备 - 为@添加代码提示和插件"></a>项目准备 - 为@添加代码提示和插件</h3><p>与md文档一致</p>
<h3 id="vuex-复习-state和getters的使用-8"><a href="#vuex-复习-state和getters的使用-8" class="headerlink" title="vuex-复习-state和getters的使用-8"></a>vuex-复习-state和getters的使用-8</h3><p><img src="/./image/image_GyiA9giL8t.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="vuex-复习-mutations"><a href="#vuex-复习-mutations" class="headerlink" title="vuex-复习-mutations"></a>vuex-复习-mutations</h3><p><img src="/./image/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_1681351331205_GyLPbiUviS.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="vuex-复习-actions"><a href="#vuex-复习-actions" class="headerlink" title="vuex-复习-actions"></a>vuex-复习-actions</h3><p><img src="/./image/image_qfXe48ApuE.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="引进和使用vuex的持久化"><a href="#引进和使用vuex的持久化" class="headerlink" title="引进和使用vuex的持久化"></a>引进和使用vuex的持久化</h3><p><img src="/./image/image_Yp7wQ-hH5E.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="添加拦截器-课程md复制即可"><a href="#添加拦截器-课程md复制即可" class="headerlink" title="添加拦截器 - 课程md复制即可"></a>添加拦截器 - 课程md复制即可</h3><p>官网:<a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/api/interceptor.html" title="https://uniapp.dcloud.net.cn/api/interceptor.html">https://uniapp.dcloud.net.cn/api/interceptor.html</a></p>
<h3 id="测试拦截器"><a href="#测试拦截器" class="headerlink" title="测试拦截器"></a>测试拦截器</h3><ol>
<li>引进封装请求的方法</li>
<li>onload中调用，看到返回的数据即可</li>
</ol>
<p><img src="/./image/image_2ctuHnX_ZH.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="tabbar搭建"><a href="#tabbar搭建" class="headerlink" title="tabbar搭建"></a>tabbar搭建</h3><ol>
<li>可以直接在官网上搜索 tabbar，或者路径在 官网-全局文件-页面配置pages.json-tabbar</li>
<li>找到实例代码，修改即可</li>
</ol>
<h3 id="自定义导航栏"><a href="#自定义导航栏" class="headerlink" title="自定义导航栏"></a>自定义导航栏</h3><ol>
<li>自定义导航栏</li>
<li>页面引进和使用</li>
</ol>
<p><img src="/./image/image_3aYOK9hIvW.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="安全区域-top代表安全区域起点"><a href="#安全区域-top代表安全区域起点" class="headerlink" title="安全区域 - top代表安全区域起点"></a>安全区域 - top代表安全区域起点</h3><ol>
<li>uni.getWindowInfo() 同步获取到设备的信息，其中safeArea代表安全区域</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 同步返回，getWindowInfo</span></span><br><span class="line">  <span class="keyword">const</span> safeArea = uni.<span class="title function_">getWindowInfo</span>().<span class="property">safeArea</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">safeArea</span> = safeArea;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>页面上保存数据，并且在标签中绑定样式，从而确定安全高度即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">safeArea</span>: <span class="literal">null</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>标签绑定样式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="keyword">class</span>=<span class="string">&quot;nav&quot;</span> :style=<span class="string">&quot;&#123; height: safeArea.top + &#x27;px&#x27; &#125;&quot;</span>&gt;我是自定义导航栏&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_aMFoDIepaX.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="胶囊的安全区域-top代表胶囊安全区域起点"><a href="#胶囊的安全区域-top代表胶囊安全区域起点" class="headerlink" title="胶囊的安全区域 - top代表胶囊安全区域起点"></a>胶囊的安全区域 - top代表胶囊安全区域起点</h3><p>1.uni.getMenuButtonBoundingClientRect() 同步获取到设备的信息</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 胶囊的安全区域</span></span><br><span class="line"><span class="keyword">const</span> jiaonang = uni.<span class="title function_">getMenuButtonBoundingClientRect</span>();</span><br><span class="line"><span class="comment">// console.log(&quot;胶囊的安全区域 -----&gt; &quot;, jiaonang);</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">jiaonang</span> = jiaonang;</span><br></pre></td></tr></table></figure>

<ol>
<li>页面上保存数据，并且在标签中绑定样式，从而确定安全高度即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">safeArea</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">jiaonang</span>: <span class="literal">null</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>标签绑定样式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="keyword">class</span>=<span class="string">&quot;jiaonang&quot;</span> :style=<span class="string">&quot;&#123; height: jiaonang.top + &#x27;px&#x27; &#125;&quot;</span></span><br><span class="line">  &gt;我是胶囊的安全区域&lt;/view</span><br><span class="line">&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;jiaonangBGC&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; height: jiaonang.height + &#x27;px&#x27; &#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span>胶囊的背景色&lt;/view</span></span><br><span class="line"><span class="language-xml">&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.nav</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">background-color</span>: greenyellow;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.jiaonang</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">background-color</span>: red;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.jiaonangBGC</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">background-color</span>: pink;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_fArJGFQZw7.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="使用vuex完成顶部导航栏"><a href="#使用vuex完成顶部导航栏" class="headerlink" title="使用vuex完成顶部导航栏"></a>使用vuex完成顶部导航栏</h3><p>&amp;#x20; 0. Navbar.vue静态文档cv</p>
<ol>
<li>获取两个安全区域并且存到vuex</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/index.js</span></span><br><span class="line"><span class="attr">state</span>: &#123;</span><br><span class="line">  <span class="comment">// 导航栏的安全区域</span></span><br><span class="line">  <span class="attr">safeArea</span>: uni.<span class="title function_">getWindowInfo</span>().<span class="property">safeArea</span>,</span><br><span class="line">  <span class="comment">// 胶囊的安全区域</span></span><br><span class="line">  <span class="attr">capsule</span>: uni.<span class="title function_">getMenuButtonBoundingClientRect</span>(),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>页面中引入数据，并且渲染到页面上</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\index\components\Navbar.vue</span></span><br><span class="line">&lt;view <span class="keyword">class</span>=<span class="string">&quot;navbar&quot;</span> :style=<span class="string">&quot;&#123; paddingTop: safeArea.top + &#x27;px&#x27; &#125;&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>, <span class="string">&quot;capsule&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_OCJoBECrr6.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="获取主页的banners"><a href="#获取主页的banners" class="headerlink" title="获取主页的banners"></a>获取主页的banners</h3><ol>
<li>把页面对应的请求，放在对应文件里面，方便维护 @&#x2F;api&#x2F;home</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\home.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页-广告区域-小程序</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeBanner</span> = (<span class="params">distributionSite = <span class="number">1</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/home/banner&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      distributionSite,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li>页面引进并且调用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\pages\index\index.vue</span></span><br><span class="line"><span class="comment">// 引入全局组件和调用方法</span></span><br><span class="line">&lt;<span class="title class_">Carousel</span> :banners=<span class="string">&quot;banners&quot;</span>&gt;&lt;/<span class="title class_">Carousel</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; getHomeBanner &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/home&quot;</span>;</span><br><span class="line">  </span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">banners</span>: [],</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getHomeBanner</span>();</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getHomeBanner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeBanner</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">banners</span> = res.<span class="property">result</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol>
<li>静态组件接收数据和渲染(高度先不管)</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;carousel&quot;</span> <span class="attr">autoplay</span> <span class="attr">indicator-dots</span> <span class="attr">circular</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">v-for</span>=<span class="string">&quot;item in banners&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">image</span> <span class="attr">:src</span>=<span class="string">&quot;item.imgUrl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">props</span>: [<span class="string">&#x27;banners&#x27;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_f1TUIFpaAp.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="banner高度设置"><a href="#banner高度设置" class="headerlink" title="banner高度设置"></a>banner高度设置</h3><p>原理就是 设计稿的转换&amp;#x20;</p>
<p>375px  —-&gt;  750rpx<br>1px   —–&gt; 2rpx<br>140px ——&gt; 280rpx，传递这个到轮播图组件即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//  src\pages\index\index.vue</span></span><br><span class="line">&lt;<span class="title class_">Carousel</span> :banners=<span class="string">&quot;banners&quot;</span> height=<span class="string">&quot;280rpx&quot;</span>&gt;&lt;/<span class="title class_">Carousel</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  src\components\Carousel\Carousel.vue</span></span><br><span class="line"> &lt;swiper</span><br><span class="line">   <span class="keyword">class</span>=<span class="string">&quot;carousel&quot;</span></span><br><span class="line">   :style=<span class="string">&quot;&#123; height &#125;&quot;</span></span><br><span class="line">   autoplay</span><br><span class="line">   indicator-dots</span><br><span class="line">   circular</span><br><span class="line"> &gt;</span><br></pre></td></tr></table></figure>

<h3 id="分类栏目"><a href="#分类栏目" class="headerlink" title="分类栏目"></a>分类栏目</h3><ul>
<li>JSDoc注释，输入为  &#x2F; **，利用代码补全即可</li>
</ul>
<ol>
<li>在 api&#x2F;home.js 封装请求</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页-前台分类-小程序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeCategoryMutli</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/home/category/mutli&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li>页面调用请求获取类目数据</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getHomeBanner, getHomeCategoryMutli &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/home&quot;</span>;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getHomeBanner</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getHomeCategoryMutli</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getHomeBanner</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeBanner</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">banners</span> = res.<span class="property">result</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getHomeCategoryMutli</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeCategoryMutli</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">categoryHeadMutli</span> = res.<span class="property">result</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li>传递数据，CateScroll 做渲染</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">CateScroll</span> :categoryHeadMutli=<span class="string">&quot;categoryHeadMutli&quot;</span>&gt;&lt;/<span class="title class_">CateScroll</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_hzj3NB5AkM.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="栏目的滑动效果"><a href="#栏目的滑动效果" class="headerlink" title="栏目的滑动效果"></a>栏目的滑动效果</h3><ol>
<li>介绍UI组件 scroll-view scroll-x @scroll&#x3D;”handleCategory”</li>
<li>方法里打印e，拿到栏目滑动距离</li>
<li>通过safeArea 获取当前屏幕宽度</li>
<li>距离 &#x2F; 宽度拿到比例</li>
<li>设置在 translateX(比例)</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\CateScroll\CateScroll.vue</span></span><br><span class="line">  <span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// 滚动时触发的回调</span></span><br><span class="line">    <span class="title function_">handleCategory</span>(<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="comment">//   e.detail.scrollLeft 拿到的就是水平的滚动距离</span></span><br><span class="line">      <span class="comment">//   整个设备的宽度可以从 安全区域 safeArea 拿到</span></span><br><span class="line">      <span class="comment">//   console.log(this.safeArea.width);</span></span><br><span class="line">      <span class="keyword">const</span> rate = (e.<span class="property">detail</span>.<span class="property">scrollLeft</span> / <span class="variable language_">this</span>.<span class="property">safeArea</span>.<span class="property">width</span>) * <span class="number">100</span> + <span class="string">&quot;%&quot;</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">scrollLeft</span> = rate;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_LWYZ94Dg3C.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="人气推荐"><a href="#人气推荐" class="headerlink" title="人气推荐"></a>人气推荐</h3><ol>
<li>封装请求</li>
<li>页面发送请求</li>
<li>数据渲染</li>
</ol>
<p><img src="/./image/image_GqOmKUJcb0.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="页面滚动"><a href="#页面滚动" class="headerlink" title="页面滚动"></a>页面滚动</h3><p>记得把首页模块的样式cv过来啊！！！</p>
<p><img src="/./image/image_lIW8_n6C6P.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 1.自定义导航 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Navbar</span>&gt;</span><span class="tag">&lt;/<span class="name">Navbar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- 2.轮播图 --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- 3.分类栏目 --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- 4. 人气推荐 --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- 5. 新鲜好物 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="新鲜好物和热门品牌"><a href="#新鲜好物和热门品牌" class="headerlink" title="新鲜好物和热门品牌"></a>新鲜好物和热门品牌</h3><p>发送请求，拿回数据，页面渲染</p>
<p><img src="/./image/image_NnhrqlT1R-.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="猜你喜欢-列表正常渲染"><a href="#猜你喜欢-列表正常渲染" class="headerlink" title="猜你喜欢-列表正常渲染"></a>猜你喜欢-列表正常渲染</h3><ol>
<li>介绍猜你喜欢有3部分功能，1正常渲染，2下拉加载，3上拉刷新</li>
<li>完成1正常渲染即可<ol>
<li>封装api请求</li>
<li>发送请求，提醒返回数据在 res.result.items</li>
<li>为分页做好准备，定义好分类数据this.guessParams &#x3D; {page: 1,pageSize: 10};</li>
<li>看到传递的参数，和返回数据即可，页面内容渲染<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  src\pages\index\index.vue</span></span><br><span class="line">&lt;!-- 猜你喜欢 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Guess</span> <span class="attr">:homeGoodsGuessLike</span>=<span class="string">&quot;homeGoodsGuessLike&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Guess</span>&gt;</span></span></span><br><span class="line">     </span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">//   猜你喜欢</span></span><br><span class="line">    <span class="attr">homeGoodsGuessLike</span>: [],</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 猜你喜欢的分页数据</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">guessParams</span> = &#123; <span class="attr">page</span>: <span class="number">1</span>, <span class="attr">pageSize</span>: <span class="number">10</span> &#125;;</span><br><span class="line">  <span class="comment">// 猜你喜欢</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getHomeGoodsGuessLike</span>();</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getHomeGoodsGuessLike</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeGoodsGuessLike</span>(<span class="variable language_">this</span>.<span class="property">guessParams</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">homeGoodsGuessLike</span> = res.<span class="property">result</span>.<span class="property">items</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h3 id="接口小建议"><a href="#接口小建议" class="headerlink" title="接口小建议"></a>接口小建议</h3><ol>
<li>为什么不在data定义guessParams，因为我不希望guessParams改变时，页面也更新</li>
</ol>
<h3 id="猜你喜欢-分页"><a href="#猜你喜欢-分页" class="headerlink" title="猜你喜欢 - 分页"></a>猜你喜欢 - 分页</h3><ol>
<li>找到组件 scroll-view 滑到底部的api，触发方法 - @scrolltolower</li>
<li>在方法里，检查是否还有下一页的数据 - 当前页数 &lt; 后台告知的总页数<ol>
<li>有的话，页码加1，page++，发送请求</li>
<li>数据回来，要追加</li>
</ol>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!-- </span><br><span class="line">    scroll-y    允许垂直滑动</span><br><span class="line">    @scrolltolower 滑动到底部触发的事件</span><br><span class="line"> --&gt;</span><br><span class="line"> &lt;scroll-view scroll-y class=&quot;main&quot; @scrolltolower=&quot;scrolltolower&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">async onLoad() &#123;</span><br><span class="line">  // 猜你喜欢总页数，由后台小哥告诉我</span><br><span class="line">  this.pages = 1;</span><br><span class="line">  // 猜你喜欢的分页数据</span><br><span class="line">  this.guessParams = &#123; page: 1, pageSize: 10 &#125;;</span><br><span class="line">  // 猜你喜欢</span><br><span class="line">  this.getHomeGoodsGuessLike();</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  async getHomeGoodsGuessLike() &#123;</span><br><span class="line">    const res = await getHomeGoodsGuessLike(this.guessParams);</span><br><span class="line">    //   这里要改一下，改成数据追加</span><br><span class="line">    //   this.homeGoodsGuessLike = res.result.items;</span><br><span class="line">    //   改成数据追加</span><br><span class="line">    this.homeGoodsGuessLike = [</span><br><span class="line">      ...this.homeGoodsGuessLike,</span><br><span class="line">      ...res.result.items,</span><br><span class="line">    ];</span><br><span class="line">    this.pages = res.result.pages;</span><br><span class="line">  &#125;,</span><br><span class="line">  scrolltolower(e) &#123;</span><br><span class="line">    console.log(&quot;我已经滚到底部了，不要再滚了 -----&gt; &quot;, e);</span><br><span class="line">    //   是否还有下一页的数据，当前页数 &lt; 后台告知的总页数</span><br><span class="line">    if (this.guessParams.page &lt; this.guessPages) &#123;</span><br><span class="line">      // 页码+1，发送请求，数据回来追加进去</span><br><span class="line">      this.guessParams.page++;</span><br><span class="line">      this.getHomeGoodsGuessLike();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="优化-添加节流-6"><a href="#优化-添加节流-6" class="headerlink" title="优化- 添加节流-6"></a>优化- 添加节流-6</h3><ol>
<li>触底时，检测是否有请求在发送中 - 可以通过 loading 控制</li>
<li>有的话，就不要再发</li>
<li>没有的话，设置 loading 为true，发送请求，请求回来，设置为false</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">scrolltolower</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">    优化- 添加节流</span></span><br><span class="line"><span class="comment">    1. 触底时，检测是否有请求在发送中 - 可以通过 loading 控制</span></span><br><span class="line"><span class="comment">    2. 有的话，就不要再发</span></span><br><span class="line"><span class="comment">    3. 没有的话，设置 loading 为true，发送请求，请求回来，设置为false</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">loading</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">guessParams</span>.<span class="property">page</span> &lt; <span class="variable language_">this</span>.<span class="property">guessPages</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">guessParams</span>.<span class="property">page</span>++;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getHomeGoodsGuessLike</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="用户底部反馈-6"><a href="#用户底部反馈-6" class="headerlink" title="用户底部反馈-6"></a>用户底部反馈-6</h3><p><img src="/./image/image_jZ0pKIEqEg.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h2 id="day3"><a href="#day3" class="headerlink" title="day3"></a>day3</h2><h3 id="下拉刷新-10"><a href="#下拉刷新-10" class="headerlink" title="下拉刷新-10"></a>下拉刷新-10</h3><ol>
<li>查阅scroll-view的api，开启允许下拉刷新refresher-enabled和绑定下拉刷新事件refresherrefresh</li>
<li>数据处理<ol>
<li>清空旧数据 - data中的数据，页码数据</li>
<li>发送请求，拿回新数据</li>
</ol>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//src\pages\index\index.vue</span><br><span class="line"></span><br><span class="line">&lt;scroll-view</span><br><span class="line">  scroll-y</span><br><span class="line">  class=&quot;main&quot;</span><br><span class="line">  @scrolltolower=&quot;scrolltolower&quot;</span><br><span class="line">  refresher-enabled</span><br><span class="line">  @refresherrefresh=&quot;refresherrefresh&quot;</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">refresherrefresh(e) &#123;</span><br><span class="line">  /*</span><br><span class="line">        下拉刷新</span><br><span class="line">        1. 查阅api，开启允许下拉刷新refresher-enabled和绑定下拉刷新事件refresherrefresh</span><br><span class="line">        2. 数据处理</span><br><span class="line">            2.1 清空旧数据 - data中的数据，页码数据</span><br><span class="line">            2.2 发送请求，拿回新数据</span><br><span class="line">    */</span><br><span class="line">  //   console.log(&quot;下拉刷新~&quot;, e);</span><br><span class="line">  this.banners = [];</span><br><span class="line">  this.categoryHeadMutli = [];</span><br><span class="line">  this.hotMutli = [];</span><br><span class="line">  this.homeNew = [];</span><br><span class="line">  this.homeGoodsGuessLike = [];</span><br><span class="line">  this.homeGoodsGuessLikeTotal = 0;</span><br><span class="line"></span><br><span class="line">  this.pages = 1;</span><br><span class="line">  this.loading = false;</span><br><span class="line">  this.pageParams = &#123; page: 1, pageSize: 20 &#125;;</span><br><span class="line"></span><br><span class="line">  this.getHomeBanner();</span><br><span class="line">  this.getHomeCategoryMutli();</span><br><span class="line">  this.getHomeHotMutli();</span><br><span class="line">  this.getHomeNew();</span><br><span class="line">  this.getHomeGoodsGuessLike();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="下拉刷新状态"><a href="#下拉刷新状态" class="headerlink" title="下拉刷新状态"></a>下拉刷新状态</h3><ol>
<li>查阅文档refresherTriggered可以设置当前下拉刷新状态</li>
<li>一进入下拉刷新，就把状态设置为true，数据都回来了，就设置为false</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;scroll-view :refresher-triggered=<span class="string">&quot;refresherTriggered&quot;</span> &gt;</span><br><span class="line">  </span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// refresherTriggered当前下拉刷新的状态</span></span><br><span class="line">    <span class="attr">refresherTriggered</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="comment">// 一进入下拉刷新，就把状态设置为true，数据都回来了，就设置为false</span></span><br><span class="line">  <span class="title function_">refresherrefresh</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">refresherTriggered</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">refresherTriggered</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<h3 id="补充-Promise-all"><a href="#补充-Promise-all" class="headerlink" title="补充-Promise.all"></a>补充-Promise.all</h3><p>Promise.all,可以一次发送所有的请求，请求都回来之后，才进入回调</p>
<p>可以避免每一个请求都在等待的问题</p>
<p>语法： Promise.all([promise1,promise2,promiseN]).then()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">        Promise.all,可以一次发送所有的请求，请求都回来之后，才进入回调</span></span><br><span class="line"><span class="comment">        可以避免每一个请求都在等待的问题</span></span><br><span class="line"><span class="comment">        语法： Promise.all([promise1,promise2,promiseN]).then()</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">fn1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fn1，1秒完成&quot;</span>);</span><br><span class="line">        <span class="title function_">resolve</span>();</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">fn2</span>(<span class="params"></span>) &#123; <span class="comment">//和fn1 类似 &#125;</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">fn3</span>(<span class="params"></span>) &#123; <span class="comment">//和fn1 类似 &#125;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">time</span>();</span><br><span class="line">  <span class="comment">//   记得要调用 fn1(),fn2(),fn3()</span></span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="title function_">fn1</span>(), <span class="title function_">fn2</span>(), <span class="title function_">fn3</span>()]).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;所有请求都完成了&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">timeEnd</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="下拉刷新完成-注意async会把函数返回值直接变为-promise对象"><a href="#下拉刷新完成-注意async会把函数返回值直接变为-promise对象" class="headerlink" title="下拉刷新完成-注意async会把函数返回值直接变为 promise对象"></a>下拉刷新完成-注意async会把函数返回值直接变为 promise对象</h3><ol>
<li>async，会自动把返回的数据变成 promise</li>
<li>项目中使用promise.all 完成下拉刷新即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">refresherrefresh</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">refresherTriggered</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">banners</span> = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">categoryHeadMutli</span> = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hotMutli</span> = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">homeNew</span> = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">homeGoodsGuessLike</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">guessPages</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">guessParams</span> = &#123; <span class="attr">page</span>: <span class="number">1</span>, <span class="attr">pageSize</span>: <span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getHomeBanner</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getHomeCategoryMutli</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getHomeHotMutli</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getHomeNew</span>(),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getHomeGoodsGuessLike</span>(),</span><br><span class="line">    ]).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">refresherTriggered</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="推荐页面静态结构-全部在文档CV"><a href="#推荐页面静态结构-全部在文档CV" class="headerlink" title="推荐页面静态结构-全部在文档CV"></a>推荐页面静态结构-全部在文档CV</h3><ol>
<li>静态style复制</li>
<li>onLoad中写死 urlMap对象</li>
<li>data中完成页面状态</li>
<li>静态template结构cv</li>
</ol>
<h3 id="动态设置页面标题"><a href="#动态设置页面标题" class="headerlink" title="动态设置页面标题"></a>动态设置页面标题</h3><ol>
<li>从首页过来，带有参数type，与urlMap其实一一对应，拿到urlMap[type]的数据</li>
<li>动态设置标题uni.setNavigationBarTitle({ title: this.currentItem.title })</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   onLoad 中才可以拿到页面参数</span></span><br><span class="line"><span class="title function_">onLoad</span>(<span class="params">&#123; type &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// 准备好标题和对应的请求地址</span></span><br><span class="line">  <span class="keyword">const</span> urlMap = &#123;</span><br><span class="line">    <span class="number">1</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;特惠推荐&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/home/preference/mutli&quot;</span> &#125;,</span><br><span class="line">    <span class="number">2</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;爆款推荐&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/home/inVogue/mutli&quot;</span> &#125;,</span><br><span class="line">    <span class="number">3</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;一站买全&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/home/oneStop/mutli&quot;</span> &#125;,</span><br><span class="line">    <span class="number">4</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;领券中心&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/home/new/mutli&quot;</span> &#125;, <span class="comment">// 后端未提供，暂用新鲜好物url</span></span><br><span class="line">    <span class="number">5</span>: &#123; <span class="attr">title</span>: <span class="string">&quot;新鲜好物&quot;</span>, <span class="attr">url</span>: <span class="string">&quot;/home/new/mutli&quot;</span> &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// console.log(&quot;urlMap -----&gt; &quot;, urlMap[type]);</span></span><br><span class="line">  uni.<span class="title function_">setNavigationBarTitle</span>(&#123; <span class="attr">title</span>: urlMap[type].<span class="property">title</span> &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="获取当前页面的数据"><a href="#获取当前页面的数据" class="headerlink" title="获取当前页面的数据"></a>获取当前页面的数据</h3><ol>
<li>因为url在urlMap中一一对应，所以封装api时，需要把url传递过去，接口的参数字段都一样，传递data即可</li>
<li>页面 onLoad 中发送请求 const res &#x3D; await getHomeRecommend(this.currentItem.url)，参数中subType代表当前tab的id，但是首次进入，并没有id，所以可以不传，</li>
<li>看到返回的数据，里面有subTypes，下次点击时候，把id带过去即可&amp;#x20;</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/home.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 人气推荐</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; url 请求url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; data 请求数据 - subType-类型id，page-页码，pageSize-数量</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHomeRecommend</span> = (<span class="params">url, data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    url,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//src/pages/recommend/index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; getHomeRecommend &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/home&quot;</span>;</span><br><span class="line">  <span class="title function_">onLoad</span>(<span class="params">&#123; type &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> urlMap = &#123;</span><br><span class="line">      <span class="number">1</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;特惠推荐&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/hot/preference&#x27;</span> &#125;,</span><br><span class="line">      <span class="number">2</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;爆款推荐&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/hot/inVogue&#x27;</span> &#125;,</span><br><span class="line">      <span class="number">3</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;一站买全&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/hot/oneStop&#x27;</span> &#125;,</span><br><span class="line">      <span class="number">4</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;领券中心&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/hot/new&#x27;</span> &#125;, <span class="comment">// 后端未提供，暂用新鲜好物url</span></span><br><span class="line">      <span class="number">5</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;新鲜好物&#x27;</span>, <span class="attr">url</span>: <span class="string">&#x27;/hot/new&#x27;</span> &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">current</span> = urlMap[type];</span><br><span class="line">    <span class="comment">// console.log(&#x27;this.current -----&gt; &#x27;, this.current);</span></span><br><span class="line">    uni.<span class="title function_">setNavigationBarTitle</span>(&#123; <span class="attr">title</span>: <span class="variable language_">this</span>.<span class="property">current</span>.<span class="property">title</span> &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getHomeRecommend</span>();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="数据加工处理-解决返回数据无法直接遍历-后台接口已改，不用再处理"><a href="#数据加工处理-解决返回数据无法直接遍历-后台接口已改，不用再处理" class="headerlink" title="数据加工处理-解决返回数据无法直接遍历 - 后台接口已改，不用再处理"></a><del>数据加工处理-解决返回数据无法直接遍历 - 后台接口已改，不用再处理</del></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对返回的数据做处理</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">recommendList</span> = res.<span class="property">result</span>.<span class="property">subTypes</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">id</span>: v.<span class="property">id</span>,</span><br><span class="line">  <span class="attr">title</span>: v.<span class="property">title</span>,</span><br><span class="line">  <span class="attr">goodsItems</span>: res.<span class="property">result</span>.<span class="property">goodsItems</span>[v.<span class="property">id</span>],</span><br><span class="line">&#125;));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;this.recommendList -----&gt; &quot;</span>, <span class="variable language_">this</span>.<span class="property">recommendList</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_6ZVFjeI5OG.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="页面数据渲染-12"><a href="#页面数据渲染-12" class="headerlink" title="页面数据渲染-12"></a>页面数据渲染-12</h3><ol>
<li>实现轮播图</li>
<li>实现tab栏目</li>
<li>实现tab栏对应的商品列表渲染</li>
</ol>
<p>其中要改的数据和绑定的方法自己完成，看到效果即可，上拉分页下节课讲</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// template在文档自行复制,注意栏目的 &#123;&#123; item.subTypes.title &#125;&#125; 要改 &#123;&#123; item.title &#125;&#125;</span></span><br><span class="line"><span class="comment">// 遍历的数据是 recommendList 和 item.goodsItems.items</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params">&#123; type &#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bannerPicture</span> = res.<span class="property">result</span>.<span class="property">bannerPicture</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">recommendList</span> = res.<span class="property">result</span>.<span class="property">subTypes</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">changeTabs</span>(<span class="params">index</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">activeIndex</span> = index;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="推荐的分页请求"><a href="#推荐的分页请求" class="headerlink" title="推荐的分页请求"></a>推荐的分页请求</h3><ol>
<li><p>开启 scroll-view 竖直方向的滚动 scroll-y ，</p>
<p>并且绑定滚动到底部的api - @scrolltolower</p>
</li>
<li><p>拿到发送请求需要的参数, 栏目的id,当前页数page,后台的总页数pages</p>
</li>
<li><p>判断后台是否还有数据  当前页数page &lt; 后台的总页数pages</p>
<ol>
<li>页码+1，发送请求</li>
<li>数据回来，追加到数组中</li>
<li>优化 - 节流，用户体验</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 方法里面接收参数 data</span></span><br><span class="line"> <span class="keyword">async</span> <span class="title function_">getHomeRecommend</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeRecommend</span>(<span class="variable language_">this</span>.<span class="property">current</span>.<span class="property">url</span>, data);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;getHomeRecommend -----&gt; &#x27;</span>, res);</span><br><span class="line">  <span class="comment">//   轮播图</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">bannerPicture</span> = res.<span class="property">result</span>.<span class="property">bannerPicture</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">recommendList</span> = res.<span class="property">result</span>.<span class="property">subTypes</span>;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">handleScrolltolower</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentData = <span class="variable language_">this</span>.<span class="property">recommendList</span>[<span class="variable language_">this</span>.<span class="property">activeIndex</span>];</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = currentData;</span><br><span class="line">  <span class="keyword">let</span> &#123; page, pages &#125; = currentData.<span class="property">goodsItems</span>;</span><br><span class="line">  <span class="comment">//   console.log(&#x27;id,page,pages -----&gt; &#x27;, id, page, pages);</span></span><br><span class="line">  <span class="keyword">if</span> (page &lt; pages) &#123;</span><br><span class="line">    page++;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getHomeRecommend</span>(&#123; <span class="attr">subType</span>: id, page &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_XtFnV6fITR.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="数据追加"><a href="#数据追加" class="headerlink" title="数据追加"></a>数据追加</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">handleScrolltolower</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentData = <span class="variable language_">this</span>.<span class="property">recommendList</span>[<span class="variable language_">this</span>.<span class="property">activeIndex</span>];</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = currentData;</span><br><span class="line">  <span class="keyword">let</span> &#123; page, pages &#125; = currentData.<span class="property">goodsItems</span>;</span><br><span class="line">  <span class="comment">//   console.log(&#x27;id,page,pages -----&gt; &#x27;, id, page, pages);</span></span><br><span class="line">  <span class="keyword">if</span> (page &lt; pages) &#123;</span><br><span class="line">    page++;</span><br><span class="line">    <span class="comment">// this.getHomeRecommend(&#123; subType: id, page &#125;);</span></span><br><span class="line">    <span class="comment">// 返回的数据自己需要自己加工</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeRecommend</span>(<span class="variable language_">this</span>.<span class="property">current</span>.<span class="property">url</span>, &#123;</span><br><span class="line">      <span class="attr">subType</span>: id,</span><br><span class="line">      page,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 先拿到返回的数据对应的 activeIndex 内容</span></span><br><span class="line">    <span class="keyword">const</span> resData = res.<span class="property">result</span>.<span class="property">subTypes</span>[<span class="variable language_">this</span>.<span class="property">activeIndex</span>];</span><br><span class="line">    <span class="comment">// 旧的数据备份和追加</span></span><br><span class="line">    <span class="keyword">const</span> items = [</span><br><span class="line">      ...currentData.<span class="property">goodsItems</span>.<span class="property">items</span>,</span><br><span class="line">      ...resData.<span class="property">goodsItems</span>.<span class="property">items</span>,</span><br><span class="line">    ];</span><br><span class="line">    currentData.<span class="property">goodsItems</span>.<span class="property">items</span> = items;</span><br><span class="line">    <span class="comment">// 把分页等信息也同步过来</span></span><br><span class="line">    currentData.<span class="property">goodsItems</span>.<span class="property">page</span> = resData.<span class="property">goodsItems</span>.<span class="property">page</span>;</span><br><span class="line">    currentData.<span class="property">goodsItems</span>.<span class="property">pages</span> = resData.<span class="property">goodsItems</span>.<span class="property">pages</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="优化-节流"><a href="#优化-节流" class="headerlink" title="优化 - 节流"></a>优化 - 节流</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">  节流</span></span><br><span class="line"><span class="comment">  1. 通过 loading，判断当前是否有请求在发送</span></span><br><span class="line"><span class="comment">  2. if(loading) return</span></span><br><span class="line"><span class="comment">     否则 设置 loading 为 true,正常发送</span></span><br><span class="line"><span class="comment">  3. 请求回来后，把loading设置为false</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleScrolltolower</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">loading</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> currentData = <span class="variable language_">this</span>.<span class="property">recommendList</span>[<span class="variable language_">this</span>.<span class="property">activeIndex</span>];</span><br><span class="line">      <span class="keyword">const</span> &#123; id &#125; = currentData;</span><br><span class="line">      <span class="keyword">let</span> &#123; page, pages &#125; = currentData.<span class="property">goodsItems</span>;</span><br><span class="line">      <span class="comment">//   console.log(&#x27;id,page,pages -----&gt; &#x27;, id, page, pages);</span></span><br><span class="line">      <span class="keyword">if</span> (page &lt; pages) &#123;</span><br><span class="line">        page++;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// this.getHomeRecommend(&#123; subType: id, page &#125;);</span></span><br><span class="line">        <span class="comment">// 返回的数据自己需要自己加工</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeRecommend</span>(<span class="variable language_">this</span>.<span class="property">current</span>.<span class="property">url</span>, &#123;</span><br><span class="line">          <span class="attr">subType</span>: id,</span><br><span class="line">          page,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 先拿到返回的数据对应的 activeIndex 内容</span></span><br><span class="line">        <span class="keyword">const</span> resData = res.<span class="property">result</span>.<span class="property">subTypes</span>[<span class="variable language_">this</span>.<span class="property">activeIndex</span>];</span><br><span class="line">        <span class="comment">// 旧的数据备份和追加</span></span><br><span class="line">        <span class="keyword">const</span> items = [</span><br><span class="line">          ...currentData.<span class="property">goodsItems</span>.<span class="property">items</span>,</span><br><span class="line">          ...resData.<span class="property">goodsItems</span>.<span class="property">items</span>,</span><br><span class="line">        ];</span><br><span class="line">        currentData.<span class="property">goodsItems</span>.<span class="property">items</span> = items;</span><br><span class="line">        <span class="comment">// 把分页等信息也同步过来</span></span><br><span class="line">        currentData.<span class="property">goodsItems</span>.<span class="property">page</span> = resData.<span class="property">goodsItems</span>.<span class="property">page</span>;</span><br><span class="line">        currentData.<span class="property">goodsItems</span>.<span class="property">pages</span> = resData.<span class="property">goodsItems</span>.<span class="property">pages</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="优化-用户底部"><a href="#优化-用户底部" class="headerlink" title="优化 - 用户底部"></a>优化 - 用户底部</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;view</span><br><span class="line">  <span class="keyword">class</span>=<span class="string">&quot;loading&quot;</span></span><br><span class="line">  v-<span class="keyword">if</span>=<span class="string">&quot;item.goodsItems.pages !== item.goodsItems.page&quot;</span></span><br><span class="line">  &gt;正在加载...&lt;/view</span><br><span class="line">&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">v-else</span>&gt;</span>我也是有底线的<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="分类-渲染一级分类"><a href="#分类-渲染一级分类" class="headerlink" title="分类-渲染一级分类"></a>分类-渲染一级分类</h3><ol>
<li>样式，搜索框，左侧分类静态CV</li>
<li>完成接口封装，发送请求，数据渲染</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\category\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; getCategoryTop &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/category&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getCategoryTop</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getCategoryTop</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getCategoryTop</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">categoryTop</span> = res.<span class="property">result</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// src\api\category.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getCategoryTop</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/category/top&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="分类-轮播图"><a href="#分类-轮播图" class="headerlink" title="分类-轮播图"></a>分类-轮播图</h3><ol>
<li>接口，在首页-广告区域，参数distributionSite 1为首页，2为分类商品页</li>
<li>封装接口，页面调用，数据渲染</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="comment">// src\pages\category\index.vue</span></span><br><span class="line">  &lt;view <span class="keyword">class</span>=<span class="string">&quot;categories&quot;</span>&gt;</span><br><span class="line">    &lt;!-- 左侧分类 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">scroll-y</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span></span><br><span class="line">    &lt;!-- 右侧分类 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;secondary&quot;</span> <span class="attr">scroll-y</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- 焦点图 --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Carousel</span> <span class="attr">class</span>=<span class="string">&quot;banner&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200rpx&quot;</span> <span class="attr">:banners</span>=<span class="string">&quot;banners&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Carousel</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span></span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; getHomeBanner &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/home&quot;</span>;</span><br><span class="line">  </span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">banners</span>: [],</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// banner数据</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getHomeBanner</span>();</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getHomeBanner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getHomeBanner</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">banners</span> = res.<span class="property">result</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_1mmS0JJHU_.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="二级分类渲染"><a href="#二级分类渲染" class="headerlink" title="二级分类渲染"></a>二级分类渲染</h3><ol>
<li>categorySubList 其实就是 当前的children，由categoryTop和activeIndex计算得到</li>
<li>children作为二级分类标题渲染，children.goods作为二级分类商品渲染</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">categorySubList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//   可选链操作符写法,保证返回的起码是一个数组</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">categoryTop</span>?.[<span class="variable language_">this</span>.<span class="property">activeIndex</span>]?.<span class="property">children</span> || [];</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="我的模块"><a href="#我的模块" class="headerlink" title="我的模块"></a>我的模块</h3><p>cv顶部背景，头像在顶部，引入胶囊安全区域，设置在paddingTop ，看到效果即可</p>
<p><img src="/./image/image_ffT9CYeRxW.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="我的模块其他模块"><a href="#我的模块其他模块" class="headerlink" title="我的模块其他模块"></a>我的模块其他模块</h3><ol>
<li>个人资料要设置好 :style&#x3D;”{ paddingTop: capsule.bottom + ‘px’ }”</li>
<li>其余按照文档cv，能够看到下面效果即可</li>
</ol>
<p><img src="/./image/image_bGscbxtLqb.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="使用小程序自带方法获取加密手机号"><a href="#使用小程序自带方法获取加密手机号" class="headerlink" title="使用小程序自带方法获取加密手机号"></a>使用小程序自带方法获取加密手机号</h3><ol>
<li>静态结构cv</li>
<li>定义方法，方法内可以拿到用户的加密手机号(个人开发者账号无法看到效果)</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">handleGetPhoneNumber</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">// 返回用户的加密信息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;e -----&gt; &quot;</span>, e);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="通过wx-login获取用户code"><a href="#通过wx-login获取用户code" class="headerlink" title="通过wx.login获取用户code"></a>通过wx.login获取用户code</h3><ol>
<li>解释后台需要的code，是来源于 wx.login</li>
<li>wx.login是微信自带的小程序用户凭证，只要是正常的用户，都能获取到code</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params">options</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [err, &#123; code &#125;] = <span class="keyword">await</span> uni.<span class="title function_">login</span>();</span><br><span class="line">  <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">code</span> = code;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code -----&gt; &quot;</span>, code);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="day4"><a href="#day4" class="headerlink" title="day4"></a>day4</h2><h3 id="完成手机号登录"><a href="#完成手机号登录" class="headerlink" title="完成手机号登录"></a>完成手机号登录</h3><ol>
<li>把后端要的三个参数准备好</li>
<li>在api&#x2F;profile 封装请求</li>
<li>发送请求，看到返回的数据</li>
</ol>
<p>注意：个人号无法获取登录信息，所以看不到效果，先完成代码即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\profile.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMin</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/login/wxMin&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  src\pages\login\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; postLoginWxMin &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleGetPhoneNumber</span>(<span class="params">e</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; encryptedData, iv &#125; = e.<span class="property">detail</span>;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postLoginWxMin</span>(&#123;</span><br><span class="line">        encryptedData,</span><br><span class="line">        iv,</span><br><span class="line">        <span class="attr">code</span>: <span class="variable language_">this</span>.<span class="property">code</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;res -----&gt; &quot;</span>, res);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [err, &#123; code &#125;] = <span class="keyword">await</span> uni.<span class="title function_">login</span>();</span><br><span class="line">    <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">code</span> = code;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;code -----&gt; &quot;</span>, code);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="手机号模拟登录-可以看到登录效果"><a href="#手机号模拟登录-可以看到登录效果" class="headerlink" title="手机号模拟登录 - 可以看到登录效果"></a>手机号模拟登录 - 可以看到登录效果</h3><ol>
<li>复制登录按钮，绑定事件即可</li>
<li>找到文档，封装请求</li>
<li>事件内发送请求，能看到返回数据即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\profile.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 小程序登录 - 测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; phoneNumber 手机号</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postLoginWxMinSimple</span> = (<span class="params">phoneNumber</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/login/wxMin/simple&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123; phoneNumber &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  src\pages\login\index.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button phone&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;postLoginWxMinSimple&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-phone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  手机号快捷登录 - 测试</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; postLoginWxMin, postLoginWxMinSimple &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">postLoginWxMinSimple</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postLoginWxMinSimple</span>(<span class="number">15915876390</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;模拟登录 -----&gt; &quot;</span>, res);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="将登陆移植到vuex"><a href="#将登陆移植到vuex" class="headerlink" title="将登陆移植到vuex"></a>将登陆移植到vuex</h3><ol>
<li>loginWxMinSimple调用vuex中的actions<ol>
<li>import { mapActions } from “vuex”;</li>
<li>在method中 …mapActions(“user”, [“postLoginWxMinSimple”]),</li>
<li>loginWxMinSimple 中 调用 this.postLoginWxMinSimple(15915876390)</li>
</ol>
</li>
<li>调用完进入到vuex - 不提供数据，直接cv</li>
<li>记得在总模块中，把user注册进入<ol>
<li>import user from “.&#x2F;user”;</li>
<li>modules： {user}</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一共改三个文件 src\store\index.js，src\store\user.js，src\pages\login\index.vue</span></span><br><span class="line"><span class="comment">// src\store\index.js</span></span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">&quot;./user&quot;</span>;</span><br><span class="line">modules： &#123;user&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\store\user.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; postLoginWxMinSimple &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 命名空间</span></span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">profile</span>: <span class="literal">null</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">setProfile</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;payload -----&gt; &quot;</span>, payload);</span><br><span class="line">      state.<span class="property">profile</span> = payload;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// 手机号登录</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">postLoginWxMinSimple</span>(<span class="params">store, payload</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postLoginWxMinSimple</span>(payload);</span><br><span class="line">      store.<span class="title function_">commit</span>(<span class="string">&quot;setProfile&quot;</span>, res.<span class="property">result</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\login\index.vue</span></span><br><span class="line"><span class="comment">// 页面的方法名：postLoginWxMinSimple  —-  loginWxMinSimple</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button phone&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;loginWxMinSimple&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">import &#123; mapActions &#125; from &quot;vuex&quot;;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  methods: &#123;</span></span><br><span class="line"><span class="language-xml">    /* </span></span><br><span class="line"><span class="language-xml">        mapActions 语法</span></span><br><span class="line"><span class="language-xml">        1. mapActions([&#x27;方法名&#x27;])  --拿的是 根模块 的数据</span></span><br><span class="line"><span class="language-xml">        2. mapActions(&#x27;模块名&#x27;,[&#x27;方法名&#x27;])  --拿的是 模块名 的数据</span></span><br><span class="line"><span class="language-xml">    */</span></span><br><span class="line"><span class="language-xml">    ...mapActions(&quot;user&quot;, [&quot;postLoginWxMinSimple&quot;]),</span></span><br><span class="line"><span class="language-xml">    async loginWxMinSimple() &#123;</span></span><br><span class="line"><span class="language-xml">      // 不在页面直接调用了，在vuex中完成整个登录逻辑更好</span></span><br><span class="line"><span class="language-xml">      //   const res = await postLoginWxMinSimple(15915876393);</span></span><br><span class="line"><span class="language-xml">      //   直接调用 this.$store.dispatch(&#x27;uesr/postLoginWxMinSimple&#x27;,15915876393)</span></span><br><span class="line"><span class="language-xml">      this.postLoginWxMinSimple(15915876390);</span></span><br><span class="line"><span class="language-xml">    &#125;,</span></span><br><span class="line"><span class="language-xml">  &#125;,</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<h3 id="登录成功-返回上一页，显示用户数据"><a href="#登录成功-返回上一页，显示用户数据" class="headerlink" title="登录成功-返回上一页，显示用户数据"></a>登录成功-返回上一页，显示用户数据</h3><ol>
<li>测试登录后，返回上一页</li>
<li>我的页面使用模块数据 …mapState(‘user’,[‘profile’])</li>
<li>可以看到效果即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// src\store\user.js</span></span><br><span class="line"> <span class="attr">actions</span>: &#123;</span><br><span class="line">   <span class="comment">// postLoginWxMinSimple 模拟登录</span></span><br><span class="line">   <span class="keyword">async</span> <span class="title function_">postLoginWxMinSimple</span>(<span class="params">store, payload</span>) &#123;</span><br><span class="line">     <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postLoginWxMinSimple</span>(payload)</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;模拟登录 -----&gt; &#x27;</span>, res.<span class="property">result</span>);</span><br><span class="line">     store.<span class="title function_">commit</span>(<span class="string">&#x27;setProfile&#x27;</span>, res.<span class="property">result</span>)</span><br><span class="line"></span><br><span class="line">     uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&#x27;登录成功&#x27;</span> &#125;)</span><br><span class="line">     <span class="comment">// navigateBack 返回上一页，</span></span><br><span class="line">     <span class="comment">// 注意：如果是编译模式直接登录，会回不到上一页</span></span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       uni.<span class="title function_">navigateBack</span>()</span><br><span class="line">     &#125;, <span class="number">1500</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// postLoginWxMin 真实登录</span></span><br><span class="line">   <span class="keyword">async</span> <span class="title function_">postLoginWxMin</span>(<span class="params">store, payload</span>) &#123;</span><br><span class="line">     <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postLoginWxMin</span>(payload)</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;真实登录 -----&gt; &#x27;</span>, res.<span class="property">result</span>);</span><br><span class="line">     store.<span class="title function_">commit</span>(<span class="string">&#x27;setProfile&#x27;</span>, res.<span class="property">result</span>)</span><br><span class="line"></span><br><span class="line">     uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&#x27;登录成功&#x27;</span> &#125;)</span><br><span class="line">     <span class="comment">// navigateBack 返回上一页，</span></span><br><span class="line">     <span class="comment">// 注意：如果是编译模式直接登录，会回不到上一页</span></span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       uni.<span class="title function_">navigateBack</span>()</span><br><span class="line">     &#125;, <span class="number">1500</span>);</span><br><span class="line">   &#125;,</span><br><span class="line"> </span><br><span class="line"><span class="comment">//src\pages\my\index.vue  </span></span><br><span class="line"> <span class="attr">computed</span>: &#123;</span><br><span class="line">   ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>, <span class="string">&quot;capsule&quot;</span>]),</span><br><span class="line">   ...<span class="title function_">mapState</span>(<span class="string">&quot;user&quot;</span>, [<span class="string">&quot;profile&quot;</span>]),</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息静态结构-6"><a href="#修改个人信息静态结构-6" class="headerlink" title="修改个人信息静态结构-6"></a>修改个人信息静态结构-6</h3><p>全程cv代码，介绍template代码，包括头像，表单即可，不用练习</p>
<h3 id="获取个人信息-token处理-7"><a href="#获取个人信息-token处理-7" class="headerlink" title="获取个人信息-token处理 - 7"></a>获取个人信息-token处理 - 7</h3><ol>
<li>个人信息不完整，需要发请求获取</li>
<li>后端发现没有token，报401</li>
<li>拦截器<ol>
<li>请求拦截器：判断有没有token，有的就添加</li>
<li>响应拦截器：判断http返回码，目前401，跳转到登录页面 - 完成登录即可</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberProfile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/profile&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\my\profile.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; getMemberProfile &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">onLoad</span>(<span class="params">options</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">this</span>.<span class="title function_">getMemberProfile</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">getMemberProfile</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getMemberProfile</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// src\utils\http.js</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> request = &#123;</span><br><span class="line">  <span class="title function_">invoke</span>(<span class="params">args</span>) &#123;</span><br><span class="line">    <span class="comment">// 添加请求头</span></span><br><span class="line">    args.<span class="property">header</span> = &#123;</span><br><span class="line">      ...args.<span class="property">header</span>, <span class="comment">// 保留原本的 header</span></span><br><span class="line">      <span class="string">&quot;source-client&quot;</span>: <span class="string">&quot;miniapp&quot;</span>, <span class="comment">// 添加小程序端调用标识</span></span><br><span class="line">      <span class="title class_">Authorization</span>: store.<span class="property">state</span>.<span class="property">user</span>.<span class="property">profile</span>?.<span class="property">token</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (options) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">      ...options,</span><br><span class="line">      <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果返回的状态码是 401，代表没登录，跳转登录页</span></span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">statusCode</span> === <span class="number">401</span>) &#123;</span><br><span class="line">          uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">&quot;/pages/login/index&quot;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息页面-onLoad-改成-onShow"><a href="#修改个人信息页面-onLoad-改成-onShow" class="headerlink" title="修改个人信息页面 - onLoad 改成 onShow"></a>修改个人信息页面 - onLoad 改成 onShow</h3><p>主要就是介绍流程</p>
<ol>
<li>响应拦截器中，401状态码跳转到了登录页面</li>
<li>登录成功后，执行 navigateBack，又回到了个人信息页面</li>
<li>没有发送请求，修改 onLoad 改成 onShow</li>
<li>onshow代表每次页面显示都会执行</li>
<li>信息储存到memberProfile即可</li>
</ol>
<h3 id="修改个人信息-选择个人头像"><a href="#修改个人信息-选择个人头像" class="headerlink" title="修改个人信息 - 选择个人头像"></a>修改个人信息 - 选择个人头像</h3><ol>
<li>顶部安全区域，通过mapstate获取</li>
<li>演示真实的上传图片，步骤总结1. wx.chooseMedia()拿到临时地址，2地址传递给后端</li>
<li>过去使用 chooseImage，现在建议使用 chooseMedia</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\my\profile.vue</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; getMemberProfile &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//   onLoad  ----  进入页面触发一次</span></span><br><span class="line">  <span class="comment">//   onShow  ----  每次看到页面都会触发</span></span><br><span class="line">  <span class="title function_">onShow</span>(<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getMemberProfile</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// 选择用户头像</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">changeAvatar</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> [err, res] = <span class="keyword">await</span> uni.<span class="title function_">chooseMedia</span>(&#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">mediaType</span>: [<span class="string">&quot;image&quot;</span>],</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;res -----&gt; &quot;</span>, res.<span class="property">tempFiles</span>[<span class="number">0</span>].<span class="property">tempFilePath</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息-修改个人头像-13"><a href="#修改个人信息-修改个人头像-13" class="headerlink" title="修改个人信息 - 修改个人头像 - 13"></a>修改个人信息 - 修改个人头像 - 13</h3><ol>
<li>封装请求，注意不能使用 http请求，要使用 uni.uploadFile</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\profile.js</span></span><br><span class="line"><span class="comment">// 修改头像</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberProfileAvatar</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> uni.<span class="title function_">uploadFile</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/profile/avatar&quot;</span>,</span><br><span class="line">    <span class="attr">filePath</span>: data,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;file&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li>页面发送请求，打印数据，是字符串，需要转化后使用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\my\profile.vue</span></span><br><span class="line"><span class="keyword">const</span> [err1, res1] = <span class="keyword">await</span> <span class="title function_">postMemberProfileAvatar</span>(</span><br><span class="line">    res.<span class="property">tempFiles</span>[<span class="number">0</span>].<span class="property">tempFilePath</span></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">if</span> (!err1) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(res1.<span class="property">data</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">avatar</span> = data.<span class="property">result</span>.<span class="property">avatar</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息-昵称性别出生"><a href="#修改个人信息-昵称性别出生" class="headerlink" title="修改个人信息 - 昵称性别出生"></a>修改个人信息 - 昵称性别出生</h3><ol>
<li>昵称性别职业-看到性别和日期即可，日期等会处理</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">genderChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(&quot;性别选择 -----&gt; &quot;, e);</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">gender</span> = e.<span class="property">detail</span>.<span class="property">value</span>;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">handleBirthdayChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">//   console.log(&#x27;日期选择 -----&gt; &#x27;, e);</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">birthday</span> = e.<span class="property">detail</span>.<span class="property">value</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="使用dayjs完成日期格式化"><a href="#使用dayjs完成日期格式化" class="headerlink" title="使用dayjs完成日期格式化"></a>使用dayjs完成日期格式化</h3><ol>
<li>安装依赖  npm i dayjs</li>
<li>页面引进和使用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\my\profile.vue</span></span><br><span class="line">&lt;picker  :end=<span class="string">&quot;end&quot;</span> &gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&quot;dayjs&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">memberProfile</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">end</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//   onLoad  ----  进入页面触发一次</span></span><br><span class="line">  <span class="comment">//   onShow  ----  每次看到页面都会触发</span></span><br><span class="line">  <span class="title function_">onLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;dayjs() -----&gt; &quot;</span>, <span class="title function_">dayjs</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>));</span><br><span class="line">    <span class="comment">// dayjs()获取到当前的时间对象</span></span><br><span class="line">    <span class="comment">// dayjs().format(&quot;YYYY-MM-DD&quot;) 格式化 YYYY-MM-DD</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">end</span> = <span class="title function_">dayjs</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息-地址选择"><a href="#修改个人信息-地址选择" class="headerlink" title="修改个人信息 - 地址选择"></a>修改个人信息 - 地址选择</h3><ol>
<li>绑定方法，打印e，看到返回的数据，有中文，有code</li>
<li>code传递给后端，中文做页面展示</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省市区</span></span><br><span class="line"><span class="title function_">handleFullLocationChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(&quot;e -----&gt; &quot;, e);</span></span><br><span class="line">  <span class="keyword">const</span> &#123; code, value &#125; = e.<span class="property">detail</span>;</span><br><span class="line">  <span class="comment">// value 是前端展示的省市区</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">fullLocation</span> = value.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="comment">// code 是传递给后端的编码</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">provinceCode</span> = code[<span class="number">0</span>];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">cityCode</span> = code[<span class="number">1</span>];</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">countyCode</span> = code[<span class="number">2</span>];</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="修改个人信息"><a href="#修改个人信息" class="headerlink" title="修改个人信息"></a>修改个人信息</h3><ol>
<li>封装接口</li>
<li>准备好传递给后台的数据</li>
<li>调用接口</li>
<li>用户反馈 - 提示信息和返回上一页</li>
<li>修改信息后，我的页面不同步，下章节再讲</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberProfile</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/profile&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;put&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\my\profile.vue</span></span><br><span class="line"><span class="comment">// 保存用户信息</span></span><br><span class="line"><span class="keyword">import</span> &#123; putMemberProfile &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/profile&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">handleSubmitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = &#123; ...<span class="variable language_">this</span>.<span class="property">memberProfile</span> &#125;;</span><br><span class="line">  <span class="comment">// 如果后台不接收 id 、accout 等字段，那么我们需要主动删除</span></span><br><span class="line">  <span class="comment">// delete data.id</span></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberProfile</span>(data);</span><br><span class="line">  <span class="comment">// 用户提示</span></span><br><span class="line">  uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;修改成功&quot;</span> &#125;);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">navigateBack</span>();</span><br><span class="line">  &#125;, <span class="number">1500</span>);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="我的页面同步信息"><a href="#我的页面同步信息" class="headerlink" title="我的页面同步信息"></a>我的页面同步信息</h3><ol>
<li>我的页面-用户信息来源 vuex</li>
<li>修改信息-用户信息来源自身memberProfile</li>
<li>只需要在 memberProfile 修改时，也把 vuex 信息更新即可<ol>
<li>vuex只需要两个字段 avatar，nickname</li>
<li>不能直接修改 vuex中的 state，所以要用 obj &#x3D; {…vuex中的profile}</li>
<li>通过触发 mutations 修改即可<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations, mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>]),</span><br><span class="line">  ...<span class="title function_">mapState</span>(<span class="string">&quot;user&quot;</span>, [<span class="string">&quot;profile&quot;</span>]),</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  ...<span class="title function_">mapMutations</span>(<span class="string">&quot;user&quot;</span>, [<span class="string">&quot;setProfile&quot;</span>]),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">  用户修改完成后，同步修改vuex</span></span><br><span class="line"><span class="comment">  注意点</span></span><br><span class="line"><span class="comment">  1. 不能够直接修改 state 里面的数据，必须是 mutation 去修改</span></span><br><span class="line"><span class="comment">  2. 不同于小程序中的 setData(&#123;需要修改的属性&#125;)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//   this.$store.user.state.profile.avatar = this.memberProfile.avatar</span></span><br><span class="line"><span class="comment">//   this.$store.user.state.profile.nickname = this.memberProfile.nickname</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  ...<span class="variable language_">this</span>.<span class="property">profile</span>,</span><br><span class="line">  <span class="attr">avatar</span>: <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">avatar</span>,</span><br><span class="line">  <span class="attr">nickname</span>: <span class="variable language_">this</span>.<span class="property">memberProfile</span>.<span class="property">nickname</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setProfile</span>(obj);</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h3 id="账号管理-静态结构"><a href="#账号管理-静态结构" class="headerlink" title="账号管理-静态结构"></a>账号管理-静态结构</h3><ol>
<li>静态结构cv</li>
<li>引入vuex中的profile，看到效果即可</li>
</ol>
<h3 id="地址管理-静态结构"><a href="#地址管理-静态结构" class="headerlink" title="地址管理-静态结构"></a>地址管理-静态结构</h3><ol>
<li>介绍功能，静态cv，数据分析</li>
</ol>
<h3 id="新建地址-静态结构和数据分析"><a href="#新建地址-静态结构和数据分析" class="headerlink" title="新建地址 - 静态结构和数据分析"></a>新建地址 - 静态结构和数据分析</h3><ol>
<li>介绍功能，静态cv，数据分析</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">对着md文档复制</span><br><span class="line">账号管理：src\pages\my\settings.vue - 注意需要自己引进 vuex 的 profile</span><br><span class="line">地址管理：src\pages\my\address\index.vue</span><br><span class="line">新建地址：src\pages\my\address\form.vue</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="新建地址完成-12"><a href="#新建地址完成-12" class="headerlink" title="新建地址完成 - 12"></a>新建地址完成 - 12</h3><ol>
<li>封装接口</li>
<li>准备好后台需要的数据</li>
<li>发送请求，看到成功即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\address.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postHomeAddress</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/address&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\pages\my\address\form.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; postHomeAddress &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/address&quot;</span>;</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">regionChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">//   console.log(&#x27;e -----&gt; &#x27;, e);</span></span><br><span class="line">    <span class="keyword">const</span> &#123; code, postcode, value &#125; = e.<span class="property">detail</span>;</span><br><span class="line">    <span class="comment">//   后台的省市区编码</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">provinceCode</span> = code[<span class="number">0</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">cityCode</span> = code[<span class="number">1</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">countyCode</span> = code[<span class="number">2</span>];</span><br><span class="line">    <span class="comment">//   后台的邮编</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">postalCode</span> = postcode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//   前端页面省市区显示</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">fullLocation</span> = value.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 是否默认 - 1为是，0为否</span></span><br><span class="line">  <span class="title function_">isDefaultChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">//   console.log(&#x27;e -----&gt; &#x27;, e);</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">isDefault</span> = e.<span class="property">detail</span>.<span class="property">value</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 提交表单</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = &#123; ...<span class="variable language_">this</span>.<span class="property">form</span> &#125;;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postMemberAddress</span>(data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="收货地址列表渲染"><a href="#收货地址列表渲染" class="headerlink" title="收货地址列表渲染"></a>收货地址列表渲染</h3><ol>
<li>新增成功提示用户和返回上一页</li>
<li>封装请求，发送请求</li>
<li>注意使用 onShow，防止新增&#x2F;修改时数据不同步</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\my\address\form.vue  </span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> obj = &#123; ...<span class="variable language_">this</span>.<span class="property">form</span> &#125;;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;obj -----&gt; &quot;</span>, obj);</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postHomeAddress</span>(obj);</span><br><span class="line">  uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;新增成功&quot;</span> &#125;);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">navigateBack</span>();</span><br><span class="line">  &#125;, <span class="number">1500</span>);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\api\address.js    </span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberAddress</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/address&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\pages\my\address\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; getMemberAddress &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/address&quot;</span>;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">onShow</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getMemberAddress</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">addressList</span> = res.<span class="property">result</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="day5"><a href="#day5" class="headerlink" title="day5"></a>day5</h2><h3 id="收货地址修改"><a href="#收货地址修改" class="headerlink" title="收货地址修改"></a>收货地址修改</h3><ol>
<li>都是同一个页面，但是地址修改会带上id，onLoad中获取</li>
<li>修改标题 uni.setNavigationBarTitle({ title: “编辑地址” });</li>
<li>根据id发请求，拿到数据保存到form，看到效果<ol>
<li>返回的字段多了一个id，没影响，而且必须要留着传到后端，所以直接赋值</li>
</ol>
</li>
<li>根据id，调用接口是新建还是编辑 - 等会讲</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\address.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询收货地址详情</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMemberAddressDetail</span> = (<span class="params">id</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/address/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\my\address\form.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; postHomeAddress, getMemberAddressDetail &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/address&quot;</span>;</span><br><span class="line"><span class="title function_">onLoad</span>(<span class="params">&#123; id &#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;id -----&gt; &quot;</span>, id);</span><br><span class="line">  <span class="keyword">if</span> (id) &#123;</span><br><span class="line">    <span class="comment">// 编辑</span></span><br><span class="line">    uni.<span class="title function_">setNavigationBarTitle</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;编辑地址&quot;</span> &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getMemberAddressDetail</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 新建</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getMemberAddressDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getMemberAddressDetail</span>(<span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">form</span> = res.<span class="property">result</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编辑收货地址完成-10</p>
<ol>
<li>提交方法里，打印 this.form.id,说明编辑是有id，新建无id</li>
<li>封装编辑地址接口</li>
<li>根据id判断，调用哪个接口<ol>
<li>注意编辑时，传递到后端的参数不需要id，所以要先删除再调用<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\address.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberAddressDetail</span> = (<span class="params">id, data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/address/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;put&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\my\address\form.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123;  putMemberAddressDetail &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/address&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">async</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="comment">// 有id，代表编辑，调用编辑接口</span></span><br><span class="line">    <span class="keyword">const</span> obj = &#123; ...<span class="variable language_">this</span>.<span class="property">form</span> &#125;;</span><br><span class="line">    <span class="comment">// 真有后台不要的字段，记得删掉 delete obj.xxx</span></span><br><span class="line">    <span class="comment">// 因为后台不要id，建议删除 id</span></span><br><span class="line">    <span class="keyword">delete</span> obj.<span class="property">id</span>;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberAddressDetail</span>(<span class="variable language_">this</span>.<span class="property">form</span>.<span class="property">id</span>, obj);</span><br><span class="line">    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;编辑成功&quot;</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 没id，代表新增，调用新增接口</span></span><br><span class="line">    <span class="keyword">const</span> obj = &#123; ...<span class="variable language_">this</span>.<span class="property">form</span> &#125;;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postHomeAddress</span>(obj);</span><br><span class="line">    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;新增成功&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    uni.<span class="title function_">navigateBack</span>();</span><br><span class="line">  &#125;, <span class="number">1500</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h3 id="删除收货地址"><a href="#删除收货地址" class="headerlink" title="删除收货地址"></a>删除收货地址</h3><ol>
<li>查阅uni-swipe-action组件</li>
<li>定义onAddressRemove方法，看到id</li>
<li>const [err, { confirm }] &#x3D; await uni.showModal 弹出确认框</li>
<li>删除后重新发送列表请求</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\my\address\index.vue</span></span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">onAddressRemove</span>(<span class="params">id</span>) &#123;</span><br><span class="line">      <span class="comment">// console.log(&quot;id -----&gt; &quot;, id);</span></span><br><span class="line">      <span class="keyword">const</span> [err, &#123; confirm &#125;] = <span class="keyword">await</span> uni.<span class="title function_">showModal</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;删除&quot;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&quot;您确定要删除吗?&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">if</span> (confirm) &#123;</span><br><span class="line">        <span class="comment">// 删除业务</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">deleteMemberAddressDetail</span>(id);</span><br><span class="line">        uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;删除成功&quot;</span> &#125;);</span><br><span class="line">        <span class="keyword">const</span> res1 = <span class="keyword">await</span> <span class="title function_">getMemberAddress</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">addressList</span> = res1.<span class="property">result</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="商品详情-介绍和页面静态结构"><a href="#商品详情-介绍和页面静态结构" class="headerlink" title="商品详情-介绍和页面静态结构"></a>商品详情-介绍和页面静态结构</h3><ol>
<li>介绍对着md文档大纲介绍详情页面，sku下节课讲</li>
<li>静态结构cv</li>
<li>介绍数据字段的作用</li>
<li></li>
</ol>
<h3 id="自定义返回按钮"><a href="#自定义返回按钮" class="headerlink" title="自定义返回按钮"></a>自定义返回按钮</h3><ol>
<li>原生的导航栏，带有返回按钮</li>
<li>自定义的导航栏，没有返回按钮，需要自己封装</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\components\GoBackBtn\GoBackBtn.vue</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">onTap</span>(<span class="params"></span>) &#123;</span><br><span class="line">    uni.<span class="title function_">navigateBack</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\goods\index.vue</span></span><br><span class="line">&lt;!-- 返回按钮 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">GoBackBtn</span>&gt;</span><span class="tag">&lt;/<span class="name">GoBackBtn</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="获取商品详情数据"><a href="#获取商品详情数据" class="headerlink" title="获取商品详情数据"></a>获取商品详情数据</h3><ol>
<li>封装接口</li>
<li>页面调用</li>
<li>数据保存</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\goods.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 商品详情</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getGoodsDetail</span> = (<span class="params">id</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/goods&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123; id &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\pages\goods\index.vue</span></span><br><span class="line">  <span class="title function_">onLoad</span>(<span class="params">&#123; id &#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getGoodsDetail</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getGoodsDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getGoodsDetail</span>(<span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="轮播图-amp-x20"><a href="#轮播图-amp-x20" class="headerlink" title="轮播图&amp;#x20;"></a>轮播图&amp;#x20;</h3><ol>
<li>右下角指示器是自己写的，需要通过 current 控制</li>
<li>谁来控制？轮播图的@change事件</li>
<li>文档静态cv即可</li>
</ol>
<p><img src="/./image/image_ioZa2uQQ3l.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="规格参数"><a href="#规格参数" class="headerlink" title="规格参数"></a>规格参数</h3><ol>
<li>代码静态cv，名称和价格纯cv，介绍一下即可</li>
<li>规格参数cv，文字目前是写死的，但是重点注意都绑定了事件，与弹出层相关，在介绍sku部分再细说</li>
<li>介绍selectArrText是规格文本，在项目小程序上演示选择效果</li>
<li>强调目前事件，变量都不需要管，先看到效果即可</li>
</ol>
<h3 id="商品评价、商品详情、常见问题-amp-x20"><a href="#商品评价、商品详情、常见问题-amp-x20" class="headerlink" title="商品评价、商品详情、常见问题&amp;#x20;"></a>商品评价、商品详情、常见问题&amp;#x20;</h3><ol>
<li>商品评价纯静态cv</li>
<li>商品详情，介绍<ol>
<li>属性遍历v-for&#x3D;”item in goods.details.properties”</li>
<li>商品图片遍历v-for&#x3D;”(item, index) in goods.details.pictures”</li>
</ol>
</li>
<li>常见问题，介绍办法是弹出窗，等会一并讲解</li>
</ol>
<h3 id="商品详情整页面cv"><a href="#商品详情整页面cv" class="headerlink" title="商品详情整页面cv"></a>商品详情整页面cv</h3><p><img src="/./image/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_1681714122839_z7ZvPsiNt_.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="商品详情-相关推荐和用户操作"><a href="#商品详情-相关推荐和用户操作" class="headerlink" title="商品详情-相关推荐和用户操作"></a>商品详情-相关推荐和用户操作</h3><ol>
<li>封装请求</li>
<li>onLoad中直接发送</li>
<li>相关推荐和用户操作的静态结构cv</li>
</ol>
<p><img src="/./image/image_PHaCHQzyjx.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p><img src="/./image/image_POmq-rvLzO.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="商品详情-弹出层-对应4个小组件"><a href="#商品详情-弹出层-对应4个小组件" class="headerlink" title="商品详情-弹出层-对应4个小组件"></a>商品详情-弹出层-对应4个小组件</h3><ol>
<li>用户操作静态cv</li>
<li>弹出窗内容，就是4个小组件，分别复制代码到相应组件</li>
<li>怎么确定弹出的是什么内容? showHalfDialog 传递组件名</li>
<li>定义方法，调用，看到打印的组件名字即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\goods\index.vue</span></span><br><span class="line"><span class="comment">// 复制4个组件，定义方法</span></span><br><span class="line"><span class="comment">// 4个弹出层的方法</span></span><br><span class="line"><span class="title function_">showHalfDialog</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;name -----&gt; &quot;</span>, name);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="弹出层实现"><a href="#弹出层实现" class="headerlink" title="弹出层实现"></a>弹出层实现</h3><ol>
<li><p>打开uniapp官网，找到uni-popup，通过this.$refs.popup.open()打开,this.$refs.popup.close()关闭</p>
<p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html" title="https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html">https://uniapp.dcloud.net.cn/component/uniui/uni-popup.html</a></p>
</li>
<li><p>popup里面引入4个组件，通过v-show&#x3D;”layer &#x3D;&#x3D;&#x3D; ‘组件名’”确定显示</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 页面记得引进4个组件，注意代码判断用的是小写</span></span><br><span class="line">&lt;uni-popup ref=<span class="string">&quot;popup&quot;</span> type=<span class="string">&quot;bottom&quot;</span> background-color=<span class="string">&quot;#fff&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;popup-root&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">text</span> @<span class="attr">click</span>=<span class="string">&quot;hideHalfDialog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;close icon-close&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 4个组件，注意代码判断用的是小写 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Sku</span> <span class="attr">v-show</span>=<span class="string">&quot;layer === &#x27;sku&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Sku</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Shipment</span> <span class="attr">v-show</span>=<span class="string">&quot;layer === &#x27;shipment&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Shipment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Clause</span> <span class="attr">v-show</span>=<span class="string">&quot;layer === &#x27;clause&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Clause</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Helps</span> <span class="attr">v-show</span>=<span class="string">&quot;layer === &#x27;helps&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Helps</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line">&lt;/uni-popup&gt;</span><br><span class="line">      </span><br><span class="line"><span class="title function_">showHalfDialog</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="comment">// 1. 显示uni-pop弹出层</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">popup</span>.<span class="title function_">open</span>(<span class="string">&quot;bottom&quot;</span>);</span><br><span class="line">  <span class="comment">// 2. 弹出层里面，显示某一个组件即可</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">layer</span> = name;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="title function_">hideHalfDialog</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">popup</span>.<span class="title function_">close</span>();</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="sku概念-最小库存单位"><a href="#sku概念-最小库存单位" class="headerlink" title="sku概念-最小库存单位"></a>sku概念-最小库存单位</h3><ol>
<li>距离想买一台苹果手机，商店无法发货</li>
<li>文档介绍，然后打开京东，找到苹果</li>
<li>要把具体的内存，颜色，套装等都确定了，才能是一个确定的sku</li>
</ol>
<h3 id="sku算法了解-2018阿里面试题-原理讲出来就可以进阿里了"><a href="#sku算法了解-2018阿里面试题-原理讲出来就可以进阿里了" class="headerlink" title="sku算法了解 - 2018阿里面试题 - 原理讲出来就可以进阿里了"></a>sku算法了解 - 2018阿里面试题 - 原理讲出来就可以进阿里了</h3><ol>
<li>后端会返回规则参数数据，和sku数据</li>
<li>对着文档介绍黑色有所有的尺码，但是杏色只有38，怎么做到这个功能？遍历</li>
<li>但是如果还有其他的规格要处理，依靠遍历就无法实现了</li>
<li>打开掘进，介绍算法相关</li>
<li>总结，不用自己写，反正也写不出来，使用插件</li>
</ol>
<h3 id="sku插件下载和引用"><a href="#sku插件下载和引用" class="headerlink" title="sku插件下载和引用"></a>sku插件下载和引用</h3><ol>
<li>打开uniapp官网-插件-跳转插件市场，搜索sku即可</li>
<li>下载</li>
</ol>
<p><img src="/./image/image_Y0B2fjzBA3.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p><img src="/./image/image_Ie4dExs33A.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="sku关键属性介绍"><a href="#sku关键属性介绍" class="headerlink" title="sku关键属性介绍"></a>sku关键属性介绍</h3><ol>
<li>在uniapp上的官网了解sku插件使用</li>
<li>把页面代码复制</li>
<li>了解属性即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="variable constant_">SKU</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">vk-data-goods-sku-popup</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">v-model</span>=<span class="string">&quot;isShowSku&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:mode</span>=<span class="string">&quot;skuMode&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:localdata</span>=<span class="string">&quot;goodsSku&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">ref</span>=<span class="string">&quot;skuRef&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">add-cart</span>=<span class="string">&quot;onAddCart&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">buy-now</span>=<span class="string">&quot;onBuyNow&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="sku复制官网demo看效果"><a href="#sku复制官网demo看效果" class="headerlink" title="sku复制官网demo看效果"></a>sku复制官网demo看效果</h3><ol>
<li>在uniapp插件官网上，复制demo</li>
<li>页面上在 getGoodsDetail 数据回来后，放到 this.goodsSku &#x3D; ‘复制到的demo数据’<ol>
<li>sku_list，有库存的商品，所以用户可以选择</li>
<li>spec_list - 所有的规格数组</li>
</ol>
</li>
<li>绑定事件，点击时候看到效果即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">getGoodsDetail</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getGoodsDetail</span>(<span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">goods</span> = res.<span class="property">result</span>;</span><br><span class="line">  <span class="comment">//   goodsSku数据应该来源于后台返回的数据，因为现在我也不知道数据怎么用，先用官网demo，看效果</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">goodsSku</span> = <span class="string">&#x27;复制到的demo数据&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显示sku插件</span></span><br><span class="line"><span class="title function_">openSkuPopup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">isShowSku</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p><img src="/./image/image_74S0H1oaIz.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="官网demo数据和后台数据一一对应"><a href="#官网demo数据和后台数据一一对应" class="headerlink" title="官网demo数据和后台数据一一对应"></a>官网demo数据和后台数据一一对应</h3><p><img src="/./image/image__VVxka9p0a.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="根据官网文档，把后台数据处理成合适的数据"><a href="#根据官网文档，把后台数据处理成合适的数据" class="headerlink" title="根据官网文档，把后台数据处理成合适的数据"></a>根据官网文档，把后台数据处理成合适的数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">goodsSku</span> = &#123;</span><br><span class="line">    <span class="attr">_id</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">id</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">name</span>,</span><br><span class="line">    <span class="attr">goods_thumb</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">mainPictures</span>[<span class="number">0</span>],</span><br><span class="line">    <span class="comment">//  sku_list - 用户可以选择的sku数组</span></span><br><span class="line">    <span class="attr">sku_list</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">skus</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="comment">// 商品的skuId</span></span><br><span class="line">        <span class="attr">_id</span>: v.<span class="property">id</span>,</span><br><span class="line">        <span class="comment">// 商品id</span></span><br><span class="line">        <span class="attr">goods_id</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">id</span>,</span><br><span class="line">        <span class="comment">// 商品名</span></span><br><span class="line">        <span class="attr">goods_name</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">name</span>,</span><br><span class="line">        <span class="comment">// 商品主图</span></span><br><span class="line">        <span class="attr">image</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">mainPictures</span>[<span class="number">0</span>],</span><br><span class="line">        <span class="comment">// sku对应的价格</span></span><br><span class="line">        <span class="attr">price</span>: v.<span class="property">price</span>,</span><br><span class="line">        <span class="comment">// sku对应的规格名，如果不对，那就返回 vv.name</span></span><br><span class="line">        <span class="attr">sku_name_arr</span>: v.<span class="property">specs</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">vv</span>) =&gt;</span> vv.<span class="property">valueName</span>),</span><br><span class="line">        <span class="comment">// sku对应的库存</span></span><br><span class="line">        <span class="attr">stock</span>: v.<span class="property">inventory</span>,</span><br><span class="line">    &#125;)),</span><br><span class="line">    <span class="comment">// spec_list - 所有的规格数组</span></span><br><span class="line">    <span class="attr">spec_list</span>: <span class="variable language_">this</span>.<span class="property">goods</span>.<span class="property">specs</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="comment">// 规格名字对应的可选值</span></span><br><span class="line">        <span class="attr">list</span>: v.<span class="property">values</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">vv</span>) =&gt;</span> (&#123; <span class="attr">name</span>: vv.<span class="property">name</span> &#125;)),</span><br><span class="line">        <span class="comment">// 规格名字，颜色，尺寸，内存等</span></span><br><span class="line">        <span class="attr">name</span>: v.<span class="property">name</span>,</span><br><span class="line">    &#125;)),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="完善商品sku的三个小功能"><a href="#完善商品sku的三个小功能" class="headerlink" title="完善商品sku的三个小功能"></a>完善商品sku的三个小功能</h3><ol>
<li>价格，建议使用:amount-type&#x3D;’0’，也可以*100</li>
<li>openSkuPopup 设置 skuMode - 1:都显示 2:只显示购物车 3:只显示立即购买</li>
<li>在sku中的关闭事件，设置好 this.selectArrText</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="variable constant_">SKU</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">vk-data-goods-sku-popup</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">v-model</span>=<span class="string">&quot;isShowSku&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:mode</span>=<span class="string">&quot;skuMode&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:localdata</span>=<span class="string">&quot;goodsSku&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:amount-type</span>=<span class="string">&quot;0&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">ref</span>=<span class="string">&quot;skuRef&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">add-cart</span>=<span class="string">&quot;onAddCart&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">buy-now</span>=<span class="string">&quot;onBuyNow&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">close</span>=<span class="string">&quot;onClose&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//   选中的文本回显</span></span><br><span class="line">  <span class="attr">selectArrText</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="comment">// 显示sku插件</span></span><br><span class="line">  <span class="title function_">openSkuPopup</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isShowSku</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 把传过来的类型设置到 skuMode,1:都显示 2:只显示购物车 3:只显示立即购买</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">skuMode</span> = num;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// amount-type=&quot;0&quot;：设置单位为元</span></span><br><span class="line">  <span class="comment">// :mode=&quot;skuMode&quot;：设置模式 1:都显示 2:只显示购物车 3:只显示立即购买</span></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  组件关闭时，把选中的内容回显</span></span><br><span class="line"><span class="comment">  为什么不写在computed，因为页面还没渲染完就会执行</span></span><br><span class="line"><span class="comment">  这时候 this.$refs.skuRef 拿不到内容，执行后面的代码就会报错</span></span><br><span class="line"><span class="comment">  所以写在方法里面更合适</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">onClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selectArrText</span> = <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">skuRef</span>.<span class="property">selectArr</span>.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>).<span class="title function_">trim</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="加入购物车"><a href="#加入购物车" class="headerlink" title="加入购物车"></a>加入购物车</h3><ol>
<li>封装接口</li>
<li>页面调用，传递参数，参数需要 {skuId, count}即可</li>
<li>用户提示</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\cart.js</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberCart</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">http</span>(&#123; <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>, <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>, data &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加入购物车，会带上已选择好的sku商品</span></span><br><span class="line"><span class="keyword">import</span> &#123; postMemberCart &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/cart&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">onAddCart</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">//   console.log(&quot;e -----&gt; &quot;, e);</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postMemberCart</span>(&#123; <span class="attr">skuId</span>: e.<span class="property">_id</span>, <span class="attr">count</span>: e.<span class="property">buy_num</span> &#125;);</span><br><span class="line">    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&#x27;加入购物车成功&#x27;</span> &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="day6"><a href="#day6" class="headerlink" title="day6"></a>day6</h2><h3 id="对象解构和重命名"><a href="#对象解构和重命名" class="headerlink" title="对象解构和重命名"></a>对象解构和重命名</h3><ol>
<li>对参数e可以直接解构</li>
<li>解构时可以使用 : 重命名</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构使用，和重命名</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">onAddCart</span>(<span class="params">&#123;  _id: skuId, buy_num: count &#125;</span>) &#123;</span><br><span class="line">      <span class="comment">//   console.log(&quot;e -----&gt; &quot;, e);</span></span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postMemberCart</span>(&#123; skuId, count &#125;);</span><br><span class="line">      uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;加购成功&quot;</span> &#125;);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isShowSku</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="跳转购物车-跳转tabbar-使用-switchTab"><a href="#跳转购物车-跳转tabbar-使用-switchTab" class="headerlink" title="跳转购物车 - 跳转tabbar 使用 switchTab"></a>跳转购物车 - 跳转tabbar 使用 switchTab</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\pages\goods\index.vue</span></span><br><span class="line"><span class="comment">// 跳转购物车 - 使用switchTab</span></span><br><span class="line">    <span class="title function_">goCart</span>(<span class="params"></span>) &#123;</span><br><span class="line">      uni.<span class="title function_">switchTab</span>(&#123; <span class="attr">url</span>: <span class="string">&quot;/pages/cart/index&quot;</span> &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="购物车列表和登录状态"><a href="#购物车列表和登录状态" class="headerlink" title="购物车列表和登录状态"></a>购物车列表和登录状态</h3><ol>
<li>静态文档cv，包括 “状态提示” 都复制</li>
<li>获取购物车列表</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\pages\cart\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; getMemberCart &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/cart&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">onShow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getMemberCart</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getMemberCart</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">carts</span> = res.<span class="property">result</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="未登录状态下会跳转登录页的处理"><a href="#未登录状态下会跳转登录页的处理" class="headerlink" title="未登录状态下会跳转登录页的处理"></a>未登录状态下会跳转登录页的处理</h3><ol>
<li>引进用户状态</li>
<li>已登录的情况下才发送请求</li>
<li>对着md文档复制静态结构 - 购物车列表和状态提示</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 静态结构自己cv </span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>(<span class="string">&#x27;user&#x27;</span>, [<span class="string">&#x27;profile&#x27;</span>]),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="title function_">onShow</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">profile</span>?.<span class="property">token</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="商品状态的修改"><a href="#商品状态的修改" class="headerlink" title="商品状态的修改"></a>商品状态的修改</h3><ol>
<li>获取到要修改的skuId</li>
<li>获取到改变后的状态</li>
<li>封装接口，发送请求</li>
<li>数据改变后，页面更新<ol>
<li>重新发送购物车列表请求 - 简单点，建议使用</li>
<li>修改data购物车的数据</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\api\cart.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberCart</span> = (<span class="params">skuId, data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/cart/<span class="subst">$&#123;skuId&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//src\pages\cart\index.vue</span></span><br><span class="line">  @tap.<span class="property">stop</span>=<span class="string">&quot;changeSelected(item.skuId, item.selected)&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">import</span> &#123; getMemberCart, putMemberCart &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/cart&quot;</span>;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">changeSelected</span>(<span class="params">skuId, selected</span>) &#123;</span><br><span class="line">    <span class="comment">// console.log(&quot;skuId, -----&gt; &quot;, skuId, selected);</span></span><br><span class="line">    <span class="comment">// 点击完，状态得改变，所以取反就是改变后的状态</span></span><br><span class="line">    selected = !selected;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberCart</span>(skuId, &#123; selected &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="商品数量的修改"><a href="#商品数量的修改" class="headerlink" title="商品数量的修改"></a>商品数量的修改</h3><ol>
<li>获取到要修改的skuId</li>
<li>获取到改变后的数量 - changeCount(skuId, num, count, stock)<ol>
<li>最小不能小于1</li>
<li>最大不能超过库存</li>
</ol>
</li>
<li>封装接口，发送请求</li>
<li>数据改变后，页面更新</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 增加和减少的 都要改</span></span><br><span class="line">@tap=<span class="string">&quot;changeCount(item.skuId, -1, item.count, item.stock)&quot;</span></span><br><span class="line">@tap=<span class="string">&quot;changeCount(item.skuId, 1, item.count, item.stock)&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">async</span> <span class="title function_">changeCount</span>(<span class="params">skuId, num, count, stock</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;skuId, num,count,stock -----&gt; &quot;</span>, skuId, num, count, stock);</span><br><span class="line">  count += num</span><br><span class="line">  <span class="keyword">if</span> (count  &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;最少购买1个&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (count &gt; stock) &#123;</span><br><span class="line">    <span class="keyword">return</span> uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">`不能超过库存 <span class="subst">$&#123;stock&#125;</span>`</span>, <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberCart</span>(skuId, &#123; count &#125;);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="使用uniapp内置组件完成数量修改-amp-x20"><a href="#使用uniapp内置组件完成数量修改-amp-x20" class="headerlink" title="使用uniapp内置组件完成数量修改&amp;#x20;"></a>使用uniapp内置组件完成数量修改&amp;#x20;</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 商品数量，阻止冒泡 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;quantity&quot;</span> @<span class="attr">tap.stop</span>=<span class="string">&quot;() =&gt; &#123;&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- $event代表当前函数调用的附带参数 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">uni-number-box</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">v-model</span>=<span class="string">&quot;item.count&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:min</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:max</span>=<span class="string">&quot;item.stock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    @<span class="attr">change</span>=<span class="string">&quot;bindChange(item.skuId, $event)&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span><span class="tag">&lt;/<span class="name">uni-number-box</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">bindChange</span>(<span class="params">skuId, count</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;skuId,count -----&gt; &quot;</span>, skuId, count);</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberCart</span>(skuId, &#123; count &#125;);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="勾选商品的总数量和总价格-amp-x20"><a href="#勾选商品的总数量和总价格-amp-x20" class="headerlink" title="勾选商品的总数量和总价格&amp;#x20;"></a>勾选商品的总数量和总价格&amp;#x20;</h3><ol>
<li>代码forEach完成即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 勾选了的购物车数组</span></span><br><span class="line"><span class="title function_">selectedCarts</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">carts</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">selected</span>);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 勾选的商品数量</span></span><br><span class="line"><span class="title function_">selectedCartsCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">selectedCarts</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">    sum += v.<span class="property">count</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 勾选的商品总价</span></span><br><span class="line"><span class="title function_">selectedCartsPrice</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">selectedCarts</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">    sum += v.<span class="property">price</span> * v.<span class="property">count</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="计算全选状态"><a href="#计算全选状态" class="headerlink" title="计算全选状态"></a>计算全选状态</h3><ol>
<li>购物车的数量 &#x3D;&#x3D;&#x3D; 选中的数量</li>
<li>使用every对购物车做遍历判断</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">   <span class="comment">// 是否全选</span></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">      1. 选中的商品数量 === 购物车的数量</span></span><br><span class="line"><span class="comment">      2. 购物车中，每一条数据都选中了，那么我就全选的状态</span></span><br><span class="line"><span class="comment">          every 检测数组中的 每一项，都符合条件，那么就返回 true</span></span><br><span class="line"><span class="comment">          注意：对于空数组，every会直接返回 ture，所以要做兼容处理</span></span><br><span class="line"><span class="comment">          some 检测数组中的 某一项，只要有一项符合条件，那么就返回true</span></span><br><span class="line"><span class="comment">          注意：对于空数组，some会直接返回 false，所以要做兼容处理</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">isSelectedAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//   return this.selectedCarts.length === this.carts.length;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">carts</span>.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">carts</span>.<span class="title function_">every</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v.<span class="property">selected</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="全选和反选-amp-x20"><a href="#全选和反选-amp-x20" class="headerlink" title="全选和反选&amp;#x20;"></a>全选和反选&amp;#x20;</h3><ol>
<li>封装和介绍接口</li>
<li>定义方法，方法里面获取到修改后的状态</li>
<li>修改后的状态，等于当前全选按钮的状态，取反</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\cart.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 购物车全选/取消全选 &#123; selected: true &#125;,不传ids默认整个购物车修改</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">putMemberCartSelected</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/cart/selected`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// src\pages\cart\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123;  putMemberCartSelected &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/cart&quot;</span>;</span><br><span class="line"><span class="keyword">async</span> <span class="title function_">changeSelectedAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 修改后的状态，等于当前全选按钮的状态，取反</span></span><br><span class="line">  <span class="keyword">let</span> selected = !<span class="variable language_">this</span>.<span class="property">isSelectedAll</span>;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">putMemberCartSelected</span>(&#123; selected &#125;);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="删除商品-amp-x20"><a href="#删除商品-amp-x20" class="headerlink" title="删除商品&amp;#x20;"></a>删除商品&amp;#x20;</h3><ol>
<li>封装和介绍接口</li>
<li>添加上删除确认框</li>
<li>接口调用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\cart.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除购物车 &#123; ids: [skuId1,skuId2] &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteMemberCart</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/cart`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;delete&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\cart\index.vue</span></span><br><span class="line"><span class="comment">// 删除购物车商品</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">deleteCart</span>(<span class="params">skuId</span>) &#123;</span><br><span class="line">      <span class="comment">// 删除建议做用户确认</span></span><br><span class="line">      <span class="keyword">const</span> [err, &#123; confirm &#125;] = <span class="keyword">await</span> uni.<span class="title function_">showModal</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;删除&quot;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&quot;您确定要删除吗?&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">if</span> (confirm) &#123;</span><br><span class="line">        <span class="comment">// 删除业务</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">deleteMemberCart</span>(&#123; <span class="attr">ids</span>: [skuId] &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getMemberCart</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="批量删除商品"><a href="#批量删除商品" class="headerlink" title="批量删除商品"></a>批量删除商品</h3><p><img src="/./image/image_f9VwxwXWO1.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="跳转订单页"><a href="#跳转订单页" class="headerlink" title="跳转订单页"></a>跳转订单页</h3><ol>
<li>静态代码，禁用仅仅是样式，其实还是可以点击</li>
<li>定义方法，方法内也要判断是否有选中商品</li>
<li>跳转页面</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 去结算按钮</span></span><br><span class="line"><span class="title function_">goToOrderCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectedCartsCount</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;请至少选中一个商品&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">&quot;/pages/order/create/index&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="预付单-发送请求拿回数据"><a href="#预付单-发送请求拿回数据" class="headerlink" title="预付单 - 发送请求拿回数据"></a>预付单 - 发送请求拿回数据</h3><ol>
<li>静态结构CV</li>
<li>发送请求，拿回数据</li>
</ol>
<h3 id="订单-获取收货地址，存放到vuex-13"><a href="#订单-获取收货地址，存放到vuex-13" class="headerlink" title="订单 - 获取收货地址，存放到vuex-13"></a>订单 - 获取收货地址，存放到vuex-13</h3><ol>
<li>准备好 address 的全局数据，state和setSelectedAddress方法</li>
<li>store&#x2F;index.js  引进和使用模块</li>
<li>创建订单页面，引进 selectedAddress 数据</li>
<li>在地址管理页面，点击某一条地址，把地址存放到vuex中</li>
<li>优化- 选择完地址后，后退到上一页即可</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\store\address.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">selectedAddress</span>: <span class="literal">null</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">setSelectedAddress</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">      state.<span class="property">selectedAddress</span> = payload;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\store\index.js</span></span><br><span class="line"><span class="keyword">import</span> address <span class="keyword">from</span> <span class="string">&quot;./address&quot;</span>;</span><br><span class="line"><span class="attr">modules</span>: &#123;</span><br><span class="line">  user,</span><br><span class="line">  address,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//src\pages\order\create\index.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">computed</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ...<span class="title function_">mapState</span>(<span class="string">&quot;address&quot;</span>, [<span class="string">&quot;selectedAddress&quot;</span>]),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//src\pages\my\address\index.vue</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addressClick(item)&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">import &#123; mapMutations &#125; from &quot;vuex&quot;;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  methods: &#123;</span></span><br><span class="line"><span class="language-xml">    ...mapMutations(&quot;address&quot;, [&quot;setSelectedAddress&quot;]),</span></span><br><span class="line"><span class="language-xml">    // 点击某一条收货地址，存到全局的 vuex中</span></span><br><span class="line"><span class="language-xml">    addressClick(item) &#123;</span></span><br><span class="line"><span class="language-xml">      console.log(&quot;item -----&gt; &quot;, item);</span></span><br><span class="line"><span class="language-xml">      this.setSelectedAddress(item);</span></span><br><span class="line"><span class="language-xml">      // 选择完，直接后退</span></span><br><span class="line"><span class="language-xml">      uni.navigateBack();</span></span><br><span class="line"><span class="language-xml">    &#125;,</span></span><br><span class="line"><span class="language-xml">  &#125;,</span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<h3 id="地址选择-返回上一页的优化"><a href="#地址选择-返回上一页的优化" class="headerlink" title="地址选择-返回上一页的优化"></a>地址选择-返回上一页的优化</h3><ol>
<li>了解业务场景</li>
<li>阻止点击冒泡</li>
<li>返回上一页优化</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 🐛 添加阻止冒泡 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">navigator</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">:url</span>=<span class="string">&quot;`./form?id=$&#123;item.id&#125;`&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">class</span>=<span class="string">&quot;edit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  @<span class="attr">tap.stop</span>=<span class="string">&quot;() =&gt; &#123;&#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">&gt;</span></span></span><br><span class="line"><span class="language-xml">  修改</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 点击某一条收货地址，存到全局的 vuex中</span></span><br><span class="line"><span class="title function_">addressClick</span>(<span class="params">item</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;item -----&gt; &quot;</span>, item);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setSelectedAddress</span>(item);</span><br><span class="line">  <span class="comment">// 选择完，直接后退 - 太直接不好</span></span><br><span class="line">  <span class="comment">// 如果从订单页过来会带参数 from=order ，后退</span></span><br><span class="line">  <span class="comment">// 否则不需要后退</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// getCurrentPages 获取到访问记录的数组</span></span><br><span class="line">  <span class="keyword">const</span> pages = <span class="title function_">getCurrentPages</span>();</span><br><span class="line">  <span class="keyword">const</span> currentPage = pages[pages.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="keyword">from</span> &#125; = currentPage.<span class="property">options</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">from</span> === <span class="string">&quot;order&quot;</span>) &#123;</span><br><span class="line">    uni.<span class="title function_">navigateBack</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="创建预付单"><a href="#创建预付单" class="headerlink" title="创建预付单"></a>创建预付单</h3><ol>
<li>封装接口</li>
<li>字段分析</li>
<li>定义方法，调用接口<ol>
<li>判断是否有收货地址</li>
<li>收集后端需要的数据</li>
<li>调用接口</li>
<li>看到效果即可，订单创建完后，再留在页面会报错，先不管</li>
</ol>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src\api\order.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postMemberOrder</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">http</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/member/order&quot;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// src\pages\order\create\index.vue</span></span><br><span class="line"><span class="keyword">import</span> &#123; getMemberOrderPre, postMemberOrder &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/order&quot;</span>;</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    1. 封装请求</span></span><br><span class="line"><span class="comment">    2. 收集后台的数据</span></span><br><span class="line"><span class="comment">    3. 优化 - 判断是否有收货地址</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">selectedAddress</span>.<span class="property">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;请先选择收货地址&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> data = &#123;</span><br><span class="line">    <span class="attr">goods</span>: <span class="variable language_">this</span>.<span class="property">orderPre</span>.<span class="property">goods</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">count</span>: v.<span class="property">count</span>,</span><br><span class="line">      <span class="attr">skuId</span>: v.<span class="property">skuId</span>,</span><br><span class="line">    &#125;)),</span><br><span class="line">    <span class="attr">addressId</span>: <span class="variable language_">this</span>.<span class="property">selectedAddress</span>.<span class="property">id</span>,</span><br><span class="line">    <span class="attr">deliveryTimeType</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">payType</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">payChannel</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">buyerMessage</span>: <span class="variable language_">this</span>.<span class="property">buyerMessage</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data -----&gt; &quot;</span>, data);</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">postMemberOrder</span>(data);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="跳转订单详情页-带上orderId"><a href="#跳转订单详情页-带上orderId" class="headerlink" title="跳转订单详情页-带上orderId"></a>跳转订单详情页-带上orderId</h3><ol>
<li>创建完订单后，购物车已选商品全部消费掉，所以留在页面会报错</li>
<li>订单创建完后，跳转订单详情页-带上orderId</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 其余已省略</span></span><br><span class="line">  uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;创建订单成功&quot;</span> &#125;);</span><br><span class="line">  uni.<span class="title function_">navigateTo</span>(&#123; <span class="attr">url</span>: <span class="string">`/pages/order/detail?orderId=<span class="subst">$&#123;res.result.id&#125;</span>`</span> &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="购物车立即下单跳转预付单-8"><a href="#购物车立即下单跳转预付单-8" class="headerlink" title="购物车立即下单跳转预付单-8"></a>购物车立即下单跳转预付单-8</h3><ol>
<li>点击立即购买，跳转预付单页面，单上 skuId 和 count</li>
<li>预付单页面接收，有skuId 就调用立即下单接口</li>
</ol>
<p><img src="/./image/image_BtG3SBgcba.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="订单-顶部导航栏-获取设备平台"><a href="#订单-顶部导航栏-获取设备平台" class="headerlink" title="订单-顶部导航栏-获取设备平台"></a>订单-顶部导航栏-获取设备平台</h3><ol>
<li>复制文档静态结构</li>
<li>vuex中获取设备平台，platform: uni.getSystemInfoSync().platform,</li>
<li>页面引入使用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src\store\index.js</span></span><br><span class="line"><span class="attr">state</span>: &#123;</span><br><span class="line">  <span class="comment">// 导航栏的安全区域</span></span><br><span class="line">  <span class="attr">safeArea</span>: uni.<span class="title function_">getWindowInfo</span>().<span class="property">safeArea</span>,</span><br><span class="line">  <span class="comment">// 胶囊的安全区域</span></span><br><span class="line">  <span class="attr">capsule</span>: uni.<span class="title function_">getMenuButtonBoundingClientRect</span>(),</span><br><span class="line">  <span class="comment">// 获取设备平台 - getSystemInfoSync 同步获取，不建议使用 getSystemInfo 异步获取</span></span><br><span class="line">  <span class="attr">platform</span>: uni.<span class="title function_">getSystemInfoSync</span>().<span class="property">platform</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\pages\order\detail.vue</span></span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">  ...<span class="title function_">mapState</span>([<span class="string">&quot;safeArea&quot;</span>, <span class="string">&quot;platform&quot;</span>]),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="获取订单详情"><a href="#获取订单详情" class="headerlink" title="获取订单详情"></a>获取订单详情</h3><ol>
<li>封装请求</li>
<li>在上个页面拿到id，发送请求</li>
<li>看到数据回来即可</li>
</ol>
<h3 id="订单状态渲染"><a href="#订单状态渲染" class="headerlink" title="订单状态渲染"></a>订单状态渲染</h3><p><img src="/./image/image_KVJJj417K1.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p><img src="/./image/image_COMtUcslSF.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="时间格式化"><a href="#时间格式化" class="headerlink" title="时间格式化"></a>时间格式化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">countdown</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">order</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> dayjs.<span class="title function_">unix</span>(<span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">countdown</span>).<span class="title function_">format</span>(<span class="string">&quot;mm分ss秒&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;00分00秒&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="倒计时"><a href="#倒计时" class="headerlink" title="倒计时"></a>倒计时</h3><p>&amp;#x20;   判断倒计时 this.order.countdown<br>&amp;#x20;   1. 条件，开启定时器<br>&amp;#x20;   2. 倒计时内递减，到0时，需要清理定时器，修改订单状态为已取消<br>&amp;#x20;   3. 优化-离开页面时清理定时器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">onLoad</span>(<span class="params">&#123; id &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// 不建议使用异步获取 - 1626549626700042242</span></span><br><span class="line">  <span class="comment">// const res = await uni.getSystemInfo();</span></span><br><span class="line">  <span class="comment">// console.log(&quot;res -----&gt; &quot;, res.platform);</span></span><br><span class="line">  id = <span class="string">&quot;1626558390752776193&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getMemberOrderDetail</span>(id);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">order</span> = res.<span class="property">result</span>;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  判断倒计时 this.order.countdown</span></span><br><span class="line"><span class="comment">  1. 满足条件，开启定时器</span></span><br><span class="line"><span class="comment">  2. 倒计时内递减，到0时，需要清理定时器，修改订单状态为已取消</span></span><br><span class="line"><span class="comment">  3. 优化-离开页面时清理定时器</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">// this.order.countdown = 5;</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">countdown</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">countdown</span>--;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">countdown</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">orderState</span> = <span class="title class_">OrderState</span>.<span class="property">YiQuXiao</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 离开的生命周期，清理定时器</span></span><br><span class="line"><span class="title function_">onUnload</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="支付功能实现"><a href="#支付功能实现" class="headerlink" title="支付功能实现"></a>支付功能实现</h3><ol>
<li>调用后端接口，后台生成订单，返回微信支付所需参数</li>
<li>调用 <code>uni.requestPayment</code>  调起微信支付</li>
<li>支付成功，弹出提示，跳转到支付成功页面 <code>/pages/order/payment</code></li>
<li>支付失败，跳转到订单列表页面  <code>/pages/order/index</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  支付流程</span></span><br><span class="line"><span class="comment">  1. 调用后端接口，后台生成订单，返回微信支付所需参数</span></span><br><span class="line"><span class="comment">  2. 调用 `uni.requestPayment`  调起微信支付</span></span><br><span class="line"><span class="comment">  3. 支付成功，弹出提示，跳转到支付成功页面 `/pages/order/payment`</span></span><br><span class="line"><span class="comment">  4. 支付失败，跳转到订单列表页面  `/pages/order/index`</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">orderPay</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getPayWxPayMiniPay</span>(<span class="variable language_">this</span>.<span class="property">order</span>.<span class="property">id</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;res -----&gt; &quot;</span>, res);</span><br><span class="line">    <span class="keyword">const</span> [err, result] = <span class="keyword">await</span> uni.<span class="title function_">requestPayment</span>(res.<span class="property">result</span>);</span><br><span class="line">    <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">      uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;支付成功&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;success&quot;</span> &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;支付失败&quot;</span>, <span class="attr">icon</span>: <span class="string">&quot;error&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="订单状态，订单列表在md文档复制完成-amp-x20"><a href="#订单状态，订单列表在md文档复制完成-amp-x20" class="headerlink" title="订单状态，订单列表在md文档复制完成&amp;#x20;"></a>订单状态，订单列表在md文档复制完成&amp;#x20;</h3><h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><h3 id="uniapp-hbuildx"><a href="#uniapp-hbuildx" class="headerlink" title="uniapp - hbuildx"></a>uniapp - hbuildx</h3><h3 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h3><ol>
<li>打开hbuildx ，左上角 文件 - 项目 - 新建</li>
<li>输入名称，选择模板(可以选择空模板)，vue版本，不使用uniCloud</li>
</ol>
<p><img src="/./image/image_42ZCQBWe-z.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h3><p><img src="/./image/image_mGD-urqetL.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="运行时可能出现的问题"><a href="#运行时可能出现的问题" class="headerlink" title="运行时可能出现的问题"></a>运行时可能出现的问题</h3><ol>
<li>项目所需要的依赖下载太慢(教室肯定慢，耐心)</li>
<li>运行时打不开 谷歌，开发者工具，模拟器等，需要自行配置</li>
</ol>
<p><img src="/./image/image_-5r5c4U97U.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="打包项目"><a href="#打包项目" class="headerlink" title="打包项目"></a>打包项目</h3><p><img src="/./image/image_l68S4Q6-0c.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="打包可能出现的问题"><a href="#打包可能出现的问题" class="headerlink" title="打包可能出现的问题"></a>打包可能出现的问题</h3><ol>
<li>需要注册和登录 hbuildx</li>
<li>小程序(填写appid)和h5 应该没问题，打包后路径在 hbuildx 看控制台</li>
</ol>
<p><img src="/./image/image_5TxAG3Nhlo.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<ol>
<li>云打包app会比较耗费时间<ol>
<li>android包名自动生成(按提示来也行)</li>
<li>可能需要配置app的图标<br><img src="/./image/image_gaJTiyVBmF.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br><img src="/./image/image_saFZlTiZES.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
</ol>
</li>
</ol>

</article>
    
    

<ul class="trm-post-copyright">
    <li class="trm-post-copyright-author">
        <strong>Post author: </strong>
        张鱼锅巴
    </li>
    <li class="trm-post-copyright-link">
        <strong>Post link: </strong>
        <a id="original-link" href="https://1999zaz.github.io/2022/07/17/uniapp-rabbit-hefei/" title="complete Uniapp demo">https://1999zaz.github.io/2022/07/17/uniapp-rabbit-hefei/</a>
    </li>
    <li class="trm-post-copyright-license">
        <strong>Copyright Notice: </strong>
        All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 ">CC BY-NC-SA 4.0</a> unless otherwise stated.
    </li>
</ul>

</div>
<div id="post-next-prev" class="row">
    <div class="col-lg-12">
        <!-- title -->
        <h5 class="trm-title-with-divider">
            Other Articles
            <span data-number="02"></span>
        </h5>
    </div>
    
        <div class="col-lg-6">
    <div class="trm-older-publications-card trm-scroll-animation trm-active-el" data-scroll="" data-scroll-offset="40">
        <div class="trm-older-publication">
            
            <a class="trm-op-top trm-anima-link" href="/2022/09/03/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%97%A0%E6%84%9F%E5%88%B7%E6%96%B0/">
                <span class="trm-op-cover">
                    <img alt="cover" class="no-fancybox" src="/img/block.jpg">
                </span>
                <h6 class="trm-op-title">小程序是如何实现无感刷新</h6>
            </a>
            <div class="trm-divider trm-mb-15 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>22/09/03</li>
                <li>19:29</li>
                <li>学习之路</li>
            </ul>
        </div>
    </div>
</div>
    
    
        <div class="col-lg-6">
    <div class="trm-older-publications-card trm-scroll-animation trm-active-el" data-scroll="" data-scroll-offset="40">
        <div class="trm-older-publication">
            
            <a class="trm-op-top trm-anima-link" href="/2022/03/02/%E4%B8%80%E4%BA%9Bvscode%E6%A0%BC%E5%BC%8F%E9%85%8D%E7%BD%AE/">
                <span class="trm-op-cover">
                    <img alt="cover" class="no-fancybox" src="https://tse3-mm.cn.bing.net/th/id/OIP-C.fnmA2ubzvBQYO1oj6yixuAHaE-?pid=ImgDet&rs=1">
                </span>
                <h6 class="trm-op-title">一些vscode格式配置</h6>
            </a>
            <div class="trm-divider trm-mb-15 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>22/03/02</li>
                <li>14:35</li>
                <li>学习之路</li>
            </ul>
        </div>
    </div>
</div>
    
</div>

    



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    <footer class="trm-scroll-animation" data-scroll data-scroll-offset="50">

    

    
        <div class="trm-footer-item">
            <span>© 2022- 2023</span>
            <span class="footer-separator"data-separator=" · "></span>
            <span class="trm-accent-color">张鱼锅巴</span>
        </div>
    

    
        <div class="trm-footer-item">
            <span>
                Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v6.3.0
            </span>
            <span class="footer-separator" data-separator=" | "></span>
            <span> 
                Theme - 
                <a rel="noopener" href='https://github.com/MaLuns/hexo-theme-async' target='_blank'>Async</a>
                v2.0.5
            </span>
        </div>
      

    
        <div class="trm-footer-item">
            The blog has been lovely to run <span id="since" class="trm-accent-color"></span> day
        </div>
     

     
</footer>

<script>
    function show_date_time () {
        var BirthDay = new Date("2022/04/10 17:00:00");
        var today = new Date();
        var timeold = (today.getTime() - BirthDay.getTime());
        var msPerDay = 24 * 60 * 60 * 1000
        var day = Math.floor(timeold / msPerDay)
        since.innerHTML = day
    }
    show_date_time()
</script>
 
                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>
            <!-- body end -->

            <div class="trm-fixed-container" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10">
    
        <div class="trm-fixed-btn" data-title="Read Mode" onclick="asyncFun.switchReadMode()">
            <i class="iconfont fas fa-book-reader"></i>
        </div>
    
    
        <div class="trm-fixed-btn" data-title="Toggle between single-column and double-column" onclick="asyncFun.switchSingleColumn()">
            <i class="iconfont fas fa-arrows-alt-h"></i>
        </div>
    
    <div id="trm-back-top" class="trm-fixed-btn" data-title="Back To Top">
        <i class="iconfont fas fa-arrow-up"></i>
    </div>
</div>
          </div>
        </div>
      </div>
      <!-- scroll container end -->

  </div>
  <!-- app wrapper end -->

  
    <div class="trm-search-popup">
        <div class="trm-search-wrapper">
            <div class="form trm-search-form">
                <div class="trm-search-input-icon">
                    <i class="iconfont fas fa-search"></i>
                </div>
                <input class="trm-search-input" type="text" placeholder="Searching...">
                <div class="trm-search-btn-close">
                    <i class="iconfont fas fa-times"></i>
                </div>
            </div>
            <div class="trm-search-result-container">
                <div class="trm-search-empty">
                    Please enter keywords to search
                </div>
            </div>
            <div class="trm-search-footer">
                <div class="trm-search-stats"></div>
                <ul class="trm-search-commands">
                    <li>
                        <kbd class="command-palette-commands-key">
                            <svg width="15" height="15" aria-label="Escape key" role="img">
                                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="1.2">
                                    <path
                                        d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956">
                                    </path>
                                </g>
                            </svg>
                        </kbd>
                        <span class="command-palette-Label">to close</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

  <!-- Plugin -->




    
<script src="https://unpkg.com/swup@2.0.19/dist/swup.min.js"></script>

    
<script src="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>

    
<script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

    

    
        <script src="/js/plugins/typing.js?v=2.0.5"></script>
    

    
        
<script src="https://unpkg.com/hexo-generator-searchdb@1.4.0/dist/search.js"></script>

        <script src="/js/plugins/local_search.js?v=2.0.5"></script>
    

    <!-- 数学公式 -->
    

    <!-- 评论插件 -->
    
        

        
    



<!-- CDN -->


    

    

    




    <!-- Service Worker -->
    
    <!-- baidu push -->
    
    <script data-swup-reload-script>
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>



<script id="async-script" src="/js/main.js?v=2.0.5"></script>

</body>

</html>